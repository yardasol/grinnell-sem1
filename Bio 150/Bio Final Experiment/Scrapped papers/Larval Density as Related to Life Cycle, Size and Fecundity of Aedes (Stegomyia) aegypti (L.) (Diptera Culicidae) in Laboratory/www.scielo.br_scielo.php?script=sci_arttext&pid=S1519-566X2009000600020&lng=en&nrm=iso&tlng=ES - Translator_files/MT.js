var BV=new function(){var _bv,_iProgress,_sFrom,_sTo;this.InitRoot=function(sBvSandboxUrl,sRef,sLayout,sDisplayLanguage,sFromLanguage,sToLanguage,sTransUrl,sCategory){if(sTransUrl&&location.search&&location.search.indexOf("f=1")>-1){var aQuery=location.search.split("&"),aTransQuery=[];for(var i=0;i<aQuery.length;++i){var mQuery=aQuery[i].match(/(\w+)=(.*)/);if(mQuery&&mQuery[1].toLowerCase()!="lo"&&mQuery[1].toLowerCase()!="dl"&&mQuery[1].toLowerCase()!="mkt"&&mQuery[1].toLowerCase()!="from"&&mQuery[1].toLowerCase()!="to"&&mQuery[1].toLowerCase()!="a"&&mQuery[1].toLowerCase()!="f"&&mQuery[1].toLowerCase()!="ref")aTransQuery.push(mQuery[0])}sTransUrl+=(sTransUrl.indexOf("?")==-1?"?":"&")+aTransQuery.join("&")}sBvSandboxUrl=sBvSandboxUrl+"?"+(sRef?"ref="+sRef:"")+(sCategory?"&category="+encodeURIComponent(sCategory):"")+(sLayout?"&lo="+sLayout:"")+(sDisplayLanguage?"&dl="+sDisplayLanguage:"")+(sFromLanguage?"&from="+sFromLanguage:"")+(sToLanguage?"&to="+sToLanguage:"")+(sTransUrl?"&a="+encodeURIComponent(sTransUrl):"");var eRequestForm=document.getElementById("RequestForm");if(eRequestForm){eRequestForm.target="SandboxFrame";eRequestForm.action=sBvSandboxUrl;eRequestForm.submit()}else document.getElementById("SandboxFrame").src=sBvSandboxUrl};this.Init=function(strBvRootUrl,strBvSandboxUrl,strUrlHash,perfEditsEnabled){this.strBvRootUrl=strBvRootUrl;this.strBvSandboxUrl=strBvSandboxUrl;this.strUrlHash=strUrlHash;this.elemLblSecureLink=document.getElementById("lblSecureLink");this.elemLblAutoDetect=document.getElementById("lblAutoDetect");this.elemFrmSrc=Layout.Properties.SrcFrame;if(this.elemFrmSrc==null){this.elemFrmSrc=document.createElement("iframe");this.elemFrmSrc.id="frmSrc";this.elemFrmSrc.frameBorder=0;document.getElementById("divSrcFrm").appendChild(this.elemFrmSrc)}this.elemFrmTgt=Layout.Properties.TgtFrame;if(this.elemFrmTgt==null){this.elemFrmTgt=document.createElement("iframe");this.elemFrmTgt.id="frmTgt";this.elemFrmTgt.frameBorder=0;document.getElementById("divTgtFrm").appendChild(this.elemFrmTgt)}Layout.Methods.SetSourceTarget(this.elemFrmSrc,this.elemFrmTgt);if(!window.Microsoft)return;var aLangCodes=Microsoft.Translator.getLanguages(),aLangNames=Microsoft.Translator.getLanguageNames(document.getElementById("locale").content);this.oLangNames={};for(var i=0;i<aLangCodes.length;++i)this.oLangNames[aLangCodes[i].toLowerCase()]=aLangNames[i];this.strAddress=Util.GetDocumentUrl(document);LangPair.Init();this.bSrcFrmLoaded=this.bTgtFrmLoaded=false;if(this.strAddress){var sURL=encodeURIComponent(this.strAddress);if(sURL.length>400)sURL=sURL.substr(0,400);var strProtocol=this.strAddress.substr(0,this.strAddress.indexOf("://")).toLowerCase();if(strProtocol=="https")if(securePrompt()){top.location.href=this.strAddress;return}else{BV.Progress.End();return}BV.Progress.Begin();if(Layout.Properties.ActiveView=="TP"){this.elemFrmSrc.src="about:blank";this.elemFrmTgt.src="proxy.ashx?h="+encodeURIComponent(this.strUrlHash)+"&a="+encodeURIComponent(this.strAddress)}else if(Layout.Properties.ActiveView=="SP"){this.elemFrmSrc.src="proxy.ashx?h="+encodeURIComponent(this.strUrlHash)+"&a="+encodeURIComponent(this.strAddress);this.elemFrmTgt.src="about:blank"}else this.elemFrmSrc.src="proxy.ashx?h="+encodeURIComponent(this.strUrlHash)+"&a="+encodeURIComponent(this.strAddress)}else{this.elemRequestForm=document.getElementById("RequestForm");if(document.getElementById("postbackonload")){BV.Go();return}var eText=document.getElementById("text");if(this.elemRequestForm&&eText){var sDocumentText=eText.value;this.elemFrmSrc.contentWindow.document.open();this.elemFrmTgt.contentWindow.document.open();if(perfEditsEnabled){this.elemFrmSrc.contentWindow.onload=function(){BV.onPostRender(BV.elemFrmSrc.contentWindow)};this.elemFrmTgt.contentWindow.onload=function(){BV.onPostRender(BV.elemFrmTgt.contentWindow)}}else{this.elemFrmSrc.contentWindow.onload=function(){setTimeout(function(){BV.onPostRender(BV.elemFrmSrc.contentWindow)},0)};this.elemFrmTgt.contentWindow.onload=function(){setTimeout(function(){BV.onPostRender(BV.elemFrmTgt.contentWindow)},0)}}if(Layout.Properties.ActiveView=="TP"){this.elemFrmSrc.contentWindow.document.write("");this.elemFrmTgt.contentWindow.document.write(sDocumentText)}else if(Layout.Properties.ActiveView=="SP"){this.elemFrmSrc.contentWindow.document.write(sDocumentText);this.elemFrmTgt.contentWindow.document.write("")}else{this.elemFrmSrc.contentWindow.document.write(sDocumentText);this.elemFrmTgt.contentWindow.document.write(sDocumentText)}this.elemFrmSrc.contentWindow.document.close();this.elemFrmTgt.contentWindow.document.close()}}if(window==top)top.location.replace("/error.aspx")};this.Go=function(aParams){var aParam="",ctl=Layout.Properties.UrlInput;if(ctl!=null)aParam=ctl.value.replace(/\s+/g,"");if(aParam=="http://")aParam="";var sBvRootUrl=BV.strBvRootUrl+"bv.aspx?"+(aParams?"&"+aParams.join("&")+"&":"")+"from="+LangPair.strFromLang+"&to="+LangPair.strToLang+(aParam?"&a="+encodeURIComponent(aParam):"");_sFrom=LangPair.strFromLang;_sTo=LangPair.strToLang;if(aParam)top.location.href=sBvRootUrl;else if(BV.elemRequestForm){BV.elemRequestForm.target="_top";BV.elemRequestForm.action=sBvRootUrl;BV.elemRequestForm.submit()}};this.OnKeyPress=function(that,evnt){var keyCode=window.event?event.keyCode:evnt?evnt.which:0;if(keyCode==13){BV.Go();return false}};this.onPreRender=function(frameWindow,strAddress){window.BVTotalTranslationRenderTime=new Date;if(strAddress.indexOf("https://")==0){if(!BV.securePrompted){BV.securePrompted=true;if(securePrompt())top.location.replace(strAddress);else history.back()}BV.Progress.End();frameWindow.location.replace("about:blank")}else{if(frameWindow==BV.elemFrmSrc.contentWindow&&(Layout.Properties.ActiveView=="SS"||Layout.Properties.ActiveView=="TB"))BV.elemFrmTgt.src="proxy.ashx?h="+this.strUrlHash+"&a="+encodeURIComponent(BV.strAddress);BV.strAddress=Layout.Properties.UrlInput.value=strAddress}_sFrom=LangPair.strFromLang;_sTo=LangPair.strToLang};this.onPostRender=function(frameWindow){rewriteLinks(frameWindow.document.getElementsByTagName("a"));rewriteLinks(frameWindow.document.getElementsByTagName("area"));rewriteForms(frameWindow.document.getElementsByTagName("form"));var framesRewritten=false;if(rewriteFrames(frameWindow,frameWindow.document.getElementsByTagName("frame")))framesRewritten=true;if(rewriteFrames(frameWindow,frameWindow.document.getElementsByTagName("iframe")))framesRewritten=true;if(frameWindow==BV.elemFrmSrc.contentWindow)BV.bSrcFrmLoaded=true;else if(frameWindow==BV.elemFrmTgt.contentWindow){BV.bTgtFrmLoaded=true;if(LangPair.strToLang.toLocaleLowerCase()=="tlh-qaak")BV.AddKlingonFontToTargetFrame(BV.elemFrmTgt.contentWindow.document.body||BV.elemFrmTgt.contentWindow.document.body)}if((BV.bSrcFrmLoaded||Layout.Properties.ActiveView=="TP")&&(BV.bTgtFrmLoaded||Layout.Properties.ActiveView=="SP")&&!BV.bTranslateRunning){setTimeout(BV.onFramesLoaded,framesRewritten?2e3:0);BV.bTranslateRunning=true}};this.AddKlingonFontToTargetFrame=function(node){if(node.nodeType==3){node.parentNode.style.fontFamily="";var styleString=node.parentNode.getAttribute("style");if(styleString)node.parentNode.setAttribute("style",styleString+";font-family:'pIqaD' !important;");else node.parentNode.setAttribute("style","font-family:'pIqaD' !important;")}for(var i=0;i<node.childNodes.length;i++)BV.AddKlingonFontToTargetFrame(node.childNodes[i])};this.InitScrollSync=function(){try{var bodyStyleObj=BV.elemFrmSrc.contentWindow.getComputedStyle?BV.elemFrmSrc.contentWindow.getComputedStyle(BV.elemFrmSrc.contentWindow.document.body,""):BV.elemFrmSrc.contentWindow.document.body.currentStyle;if(bodyStyleObj)var fromDir=bodyStyleObj.direction;if(!fromDir)fromDir="ltr";BV.elemFrmSrc.contentWindow.document["docLanguageDir"]=fromDir;var toDir=Util.getLanguageDirStyle(LangPair.strToLang);BV.elemFrmTgt.contentWindow.document["docLanguageDir"]=toDir.direction;BV.elemFrmTgt.contentWindow.document.documentElement.style.direction=toDir.direction;BV.elemFrmTgt.contentWindow.document.body.style.direction=toDir.direction;if(Layout.Properties.ActiveView=="SS"||Layout.Properties.ActiveView=="TB")if(fromDir!=toDir.direction)_bv.setHorizontalScrollToEnd(BV.elemFrmSrc.contentWindow.document,fromDir=="rtl")}catch(oError){}};this.onFramesLoaded=function(){_bv=new Microsoft.Translator.BilingualViewer(BV.elemFrmSrc.contentWindow.document,BV.elemFrmTgt.contentWindow.document,LangPair.strFromLang,LangPair.strToLang,false,true);BV.InitScrollSync();var showTooltips=Layout.Properties.ActiveView=="SP"||Layout.Properties.ActiveView=="TP";_bv.setTooltips(showTooltips,showTooltips);_bv.translate(BV.translateComplete,function(sError){},function(nProgress){BV.Progress.Update(Math.max(Math.floor(nProgress),1));var detLang=_bv.getDetectedLanguage();if(LangPair.strFromLang==""&&!LangPair.autoSet&&detLang&&BV.oLangNames[detLang]){LangPair.autoSet=true;LangPair.SetAutoDetectLanguage(BV.elemLblAutoDetect.innerHTML.replace("{0}",BV.oLangNames[detLang]),detLang)}})};this.translateComplete=function(){BV.Progress.End();var endDate=new Date;window.BVTotalTranslationRenderTime=endDate.getTime()-window.BVTotalTranslationRenderTime.getTime();console.log("Total Time : "+window.BVTotalTranslationRenderTime);console.log("Dom translation request  from outside : "+window.Microsoft.Translator.totalTranslationTime)};this.SetView=function(v){Util.SetCookie("lo",v,true);Layout.Methods.SetView(v);BV.Go(["lo="+v])};this.Progress={Begin:function(){Layout.Methods.BeginAnimation()},End:function(){Layout.Methods.EndAnimation(false)},Update:function(n){_iProgress=n;Layout.Methods.ShowAnimationPercent(n)},Hide:function(){Layout.Methods.EndAnimation(true)}};this.ReportPage=function(){var prms=[];prms[prms.length]="agent="+encodeURIComponent(navigator.userAgent);prms[prms.length]="loc="+encodeURIComponent(navigator.language||navigator.browserLanguage);prms[prms.length]="to="+encodeURIComponent(_sTo||LangPair.strToLang);prms[prms.length]="from="+encodeURIComponent(_sFrom);prms[prms.length]="url="+encodeURIComponent(BV.strAddress);prms[prms.length]="lo="+encodeURIComponent(Layout.Properties.ActiveView);if(_bv){prms[prms.length]="prgrs="+encodeURIComponent(_iProgress);if(window.Microsoft.Translator.APIResponses>0)prms[prms.length]="dtc="+encodeURIComponent(_bv.getDetectedLanguage());prms[prms.length]="reqCnt="+encodeURIComponent(window.Microsoft.Translator.APIRequests);prms[prms.length]="resCnt="+encodeURIComponent(window.Microsoft.Translator.APIResponses)}else prms[prms.length]="stat="+encodeURIComponent("Page's not loaded");Util.Log("BVPages",prms);Layout.Methods.HideBVReport();Layout.Methods.ShowBVThanksReporting()};function rewriteLinks(aLinks){for(var i=0;i<aLinks.length;++i)try{if(aLinks[i].href)if(aLinks[i].href.indexOf("http://")==0||aLinks[i].href.indexOf("https://")==0){var sTmpHTML=aLinks[i].innerHTML;aLinks[i].href=BV.strBvRootUrl+"bv.aspx?from="+LangPair.strFromLang+"&to="+LangPair.strToLang+"&a="+encodeURIComponent(aLinks[i].href);aLinks[i].innerHTML=sTmpHTML;aLinks[i].onclick=function(){};aLinks[i].target="_top"}else if(aLinks[i].href.indexOf("https://")==0){aLinks[i].onclick=securePrompt;aLinks[i].target="_top"}}catch(oError){}}function rewriteForms(aForms){for(var i=0;i<aForms.length;++i){aForms[i].target="_top";if(aForms[i].method==null||aForms[i].method=="undefined")continue;if(aForms[i].method.length==0||aForms[i].method.toLowerCase()=="get")rewriteForm(aForms[i])}}function rewriteForm(eForm){try{var sAddress=eForm.action?eForm.action:BV.strAddress;if(sAddress.indexOf("://")==-1){var mBaseMatch=BV.strAddress.match(/^([^:]*:\/\/[^\/]*)(\/[^\?\#]*)/),aPath=sAddress.substr(0,1)=="/"?[]:mBaseMatch[1].split("/"),mPathMatch=sAddress.match(/^([^?]*)(.*)$/),aRel=mPathMatch[1].split("/"),sQuery=mPathMatch[2];if(aPath.length>0&&aRel.length>0&&aRel[0]!=".")aPath.pop();while(aRel.length>0){var sRel=aRel.shift();switch(sRel){case ".":break;case "..":if(aPath.length)aPath.pop();break;default:aPath.push(sRel);break}}sAddress=mBaseMatch[1]+aPath.join("/")+sQuery}eForm.action=BV.strBvRootUrl+"bv.aspx";var eFrom=eForm.ownerDocument.createElement("input");eFrom.name="from";eFrom.type="hidden";eFrom.value=LangPair.strFromLang;eForm.appendChild(eFrom);var eTo=eForm.ownerDocument.createElement("input");eTo.name="to";eTo.type="hidden";eTo.value=LangPair.strToLang;eForm.appendChild(eTo);var eAddress=eForm.ownerDocument.createElement("input");eAddress.name="a";eAddress.type="hidden";eAddress.value=sAddress;eForm.appendChild(eAddress);var eSubForm=eForm.ownerDocument.createElement("input");eSubForm.name="f";eSubForm.type="hidden";eSubForm.value="1";eForm.appendChild(eSubForm);eForm.onsubmit=function(){eFrom.value=LangPair.strFromLang;eTo.value=LangPair.strToLang;eAddress.value=sAddress;eSubForm.value="1"}}catch(excp){}}function rewriteFrames(frameWindow,aFrames){var framesRewritten=false;if(aFrames.length)frameWindow.BV={onPreRender:function(frameWindow){},onPostRender:function(frameWindow){rewriteLinks(frameWindow.document.getElementsByTagName("a"));rewriteLinks(frameWindow.document.getElementsByTagName("area"));rewriteForms(frameWindow.document.getElementsByTagName("form"));rewriteFrames(frameWindow,frameWindow.document.getElementsByTagName("frame"));rewriteFrames(frameWindow,frameWindow.document.getElementsByTagName("iframe"))}};for(var i=0;i<aFrames.length;++i)try{if(aFrames[i].src&&aFrames[i].src.toLowerCase().indexOf("javascript:")==-1&&aFrames[i].src.toLowerCase().indexOf("about:")==-1){var frameDomain=aFrames[i].src.match(/http:\/\/([^:\/]+)/i);if(frameDomain&&frameDomain[1]&&BV.strAddress.indexOf(frameDomain[1])==-1)continue;aFrames[i].src=BV.strBvSandboxUrl+"proxy.ashx?h="+encodeURIComponent(this.strUrlHash)+"&a="+encodeURIComponent(BV.strAddress)+"&b="+encodeURIComponent(aFrames[i].src);framesRewritten=true}}catch(excp){}return framesRewritten}function securePrompt(){return confirm(BV.elemLblSecureLink.innerHTML)}return this},BV_ServerSide=new function(){var _bv,_iProgress,_sFrom,_sTo,_origSrcLang,_origDstLang;this.DetectedLanguage=null;this.InitRoot=function(sBvSandboxUrl,sRef,sLayout,sDisplayLanguage,sFromLanguage,sToLanguage,sTransUrl,iChunkSize){if(sTransUrl&&location.search&&location.search.indexOf("f=1")>-1){var aQuery=location.search.split("&"),aTransQuery=[];for(var i=0;i<aQuery.length;++i){var mQuery=aQuery[i].match(/(\w+)=(.*)/);if(mQuery&&mQuery[1].toLowerCase()!="lo"&&mQuery[1].toLowerCase()!="dl"&&mQuery[1].toLowerCase()!="mkt"&&mQuery[1].toLowerCase()!="from"&&mQuery[1].toLowerCase()!="to"&&mQuery[1].toLowerCase()!="a"&&mQuery[1].toLowerCase()!="f"&&mQuery[1].toLowerCase()!="ref"&&mQuery[1].toLowerCase()!="chunk")aTransQuery.push(mQuery[0])}sTransUrl+=(sTransUrl.indexOf("?")==-1?"?":"&")+aTransQuery.join("&")}sBvSandboxUrl=sBvSandboxUrl+"?"+(sRef?"ref="+sRef:"")+(sLayout?"&lo="+sLayout:"")+(sDisplayLanguage?"&dl="+sDisplayLanguage:"")+(sFromLanguage?"&from="+sFromLanguage:"")+(sToLanguage?"&to="+sToLanguage:"")+(iChunkSize?"&chunk="+encodeURIComponent(iChunkSize):"")+(sTransUrl?"&a="+encodeURIComponent(sTransUrl):"");var eRequestForm=document.getElementById("RequestForm");if(eRequestForm){eRequestForm.target="SandboxFrame";eRequestForm.action=sBvSandboxUrl;eRequestForm.submit()}else document.getElementById("SandboxFrame").src=sBvSandboxUrl};this.Init=function(strBvRootUrl,strBvSandboxUrl,strUrlHash,srcLang,dstLang,perfEditsEnabled,iChunkSize){_origSrcLang=srcLang;_origDstLang=dstLang;this.strBvRootUrl=strBvRootUrl;this.strBvSandboxUrl=strBvSandboxUrl;this.strUrlHash=strUrlHash;this.iChunkSize=iChunkSize;this.elemLblSecureLink=document.getElementById("lblSecureLink");this.elemLblAutoDetect=document.getElementById("lblAutoDetect");this.elemFrmSrc=Layout.Properties.SrcFrame;if(this.elemFrmSrc==null){this.elemFrmSrc=document.createElement("iframe");this.elemFrmSrc.id="frmSrc";this.elemFrmSrc.frameBorder=0;document.getElementById("divSrcFrm").appendChild(this.elemFrmSrc)}this.elemFrmTgt=Layout.Properties.TgtFrame;if(this.elemFrmTgt==null){this.elemFrmTgt=document.createElement("iframe");this.elemFrmTgt.id="frmTgt";this.elemFrmTgt.frameBorder=0;document.getElementById("divTgtFrm").appendChild(this.elemFrmTgt)}Layout.Methods.SetSourceTarget(this.elemFrmSrc,this.elemFrmTgt);if(!window.Microsoft)return;var aLangCodes=Microsoft.Translator.getLanguages(),aLangNames=Microsoft.Translator.getLanguageNames(document.getElementById("locale").content);this.oLangNames={};for(var i=0;i<aLangCodes.length;++i)this.oLangNames[aLangCodes[i].toLowerCase()]=aLangNames[i];this.strAddress=Util.GetDocumentUrl(document);LangPair.Init();this.bSrcFrmLoaded=this.bTgtFrmLoaded=false;if(this.strAddress){var sURL=encodeURIComponent(this.strAddress);if(sURL.length>400)sURL=sURL.substr(0,400);BV_ServerSide.Progress.Begin();if(Layout.Properties.ActiveView=="TP"){this.elemFrmSrc.src="about:blank";this.elemFrmTgt.src="proxy_serverside.ashx?h="+encodeURIComponent(this.strUrlHash)+"&a="+encodeURIComponent(this.strAddress)+"&from="+encodeURIComponent(_origSrcLang)+"&to="+encodeURIComponent(_origDstLang)+"&mode=TP"+"&chunk="+this.iChunkSize}else if(Layout.Properties.ActiveView=="SP"){this.elemFrmSrc.src="proxy_serverside.ashx?h="+encodeURIComponent(this.strUrlHash)+"&a="+encodeURIComponent(this.strAddress)+"&from="+encodeURIComponent(_origSrcLang)+"&to="+encodeURIComponent(_origDstLang)+"&mode=SP"+"&chunk="+this.iChunkSize;this.elemFrmTgt.src="about:blank"}else this.elemFrmSrc.src="proxy_serverside.ashx?h="+encodeURIComponent(this.strUrlHash)+"&a="+encodeURIComponent(this.strAddress)+"&notranslate=true"+"&chunk="+this.iChunkSize}else{this.elemRequestForm=document.getElementById("RequestForm");if(document.getElementById("postbackonload")){BV_ServerSide.Go();return}var eText=document.getElementById("text");if(this.elemRequestForm&&eText){var sDocumentText=eText.value;this.elemFrmSrc.contentWindow.document.open();this.elemFrmTgt.contentWindow.document.open();if(perfEditsEnabled){this.elemFrmSrc.contentWindow.onload=function(){BV_ServerSide.onPostRender(BV_ServerSide.elemFrmSrc.contentWindow)};this.elemFrmTgt.contentWindow.onload=function(){BV_ServerSide.onPostRender(BV_ServerSide.elemFrmTgt.contentWindow)}}else{this.elemFrmSrc.contentWindow.onload=function(){setTimeout(function(){BV_ServerSide.onPostRender(BV_ServerSide.elemFrmSrc.contentWindow)},0)};this.elemFrmTgt.contentWindow.onload=function(){setTimeout(function(){BV_ServerSide.onPostRender(BV_ServerSide.elemFrmTgt.contentWindow)},0)}}if(Layout.Properties.ActiveView=="TP"){this.elemFrmSrc.contentWindow.document.write("");this.elemFrmTgt.contentWindow.document.write(sDocumentText)}else if(Layout.Properties.ActiveView=="SP"){this.elemFrmSrc.contentWindow.document.write(sDocumentText);this.elemFrmTgt.contentWindow.document.write("")}else{this.elemFrmSrc.contentWindow.document.write(sDocumentText);this.elemFrmTgt.contentWindow.document.write(sDocumentText)}this.elemFrmSrc.contentWindow.document.close();this.elemFrmTgt.contentWindow.document.close()}}if(window==top)top.location.replace("/error.aspx")};this.Go=function(aParams){var aParam="",ctl=Layout.Properties.UrlInput;if(ctl!=null)aParam=ctl.value.replace(/\s+/g,"");if(aParam=="http://")aParam="";var sBvRootUrl=BV_ServerSide.strBvRootUrl+"bvserverside/bv_serverside.aspx?"+(aParams?"&"+aParams.join("&")+"&":"")+"from="+LangPair.strFromLang+"&to="+LangPair.strToLang+(aParam?"&a="+encodeURIComponent(aParam):"");_sFrom=LangPair.strFromLang;_sTo=LangPair.strToLang;if(aParam)top.location.href=sBvRootUrl;else if(BV_ServerSide.elemRequestForm){BV_ServerSide.elemRequestForm.target="_top";BV_ServerSide.elemRequestForm.action=sBvRootUrl;BV_ServerSide.elemRequestForm.submit()}};this.OnKeyPress=function(that,evnt){var keyCode=window.event?event.keyCode:evnt?evnt.which:0;if(keyCode==13){BV_ServerSide.Go();return false}};this.onPreRender=function(frameWindow,strAddress){window.BVTotalTranslationRenderTime=new Date;if(frameWindow==BV_ServerSide.elemFrmSrc.contentWindow&&(Layout.Properties.ActiveView=="SS"||Layout.Properties.ActiveView=="TB"))BV_ServerSide.elemFrmTgt.src="proxy_serverside.ashx?h="+this.strUrlHash+"&a="+encodeURIComponent(BV_ServerSide.strAddress)+"&from="+encodeURIComponent(_origSrcLang)+"&to="+encodeURIComponent(_origDstLang)+"&mode="+Layout.Properties.ActiveView+"&chunk="+this.iChunkSize;BV_ServerSide.strAddress=Layout.Properties.UrlInput.value=strAddress;_sFrom=LangPair.strFromLang;_sTo=LangPair.strToLang};this.onPostRender=function(frameWindow){rewriteLinks(frameWindow.document.getElementsByTagName("a"));rewriteLinks(frameWindow.document.getElementsByTagName("area"));rewriteForms(frameWindow.document.getElementsByTagName("form"));var framesRewritten=false;if(rewriteFrames(frameWindow,frameWindow.document.getElementsByTagName("frame")))framesRewritten=true;if(rewriteFrames(frameWindow,frameWindow.document.getElementsByTagName("iframe")))framesRewritten=true;if(frameWindow==BV_ServerSide.elemFrmSrc.contentWindow)BV_ServerSide.bSrcFrmLoaded=true;else if(frameWindow==BV_ServerSide.elemFrmTgt.contentWindow){BV_ServerSide.bTgtFrmLoaded=true;if(LangPair.strToLang.toLocaleLowerCase()=="tlh-qaak")BV_ServerSide.AddKlingonFontToTargetFrame(BV_ServerSide.elemFrmTgt.contentWindow.document.body||BV_ServerSide.elemFrmTgt.contentWindow.document.body)}if((BV_ServerSide.bSrcFrmLoaded||Layout.Properties.ActiveView=="TP")&&(BV_ServerSide.bTgtFrmLoaded||Layout.Properties.ActiveView=="SP")&&!BV_ServerSide.bTranslateRunning){setTimeout(BV_ServerSide.onFramesLoaded,framesRewritten?2e3:0);BV_ServerSide.bTranslateRunning=true}if(!BV_ServerSide.bSrcFrmLoaded&&BV_ServerSide.bTgtFrmLoaded&&(Layout.Properties.ActiveView=="TP"||Layout.Properties.ActiveView=="SS"||Layout.Properties.ActiveView=="TB")){var dstStyle=Util.getLanguageDirStyle(_origDstLang);if(Util.getLanguageDirStyle(BV_ServerSide.DetectedLanguage)!=dstStyle){var body=$(this.elemFrmTgt).contents().find("body");body.css("text-align",dstStyle.textAlign).css("direction",dstStyle.direction);var elms=body.find("*");$.each(elms,function(ind,elm){(function(elm){setTimeout(function(){if($(elm).css("text-align")!=dstStyle.textAlign&&$(elm).css("text-align")!="center")$(elm).css("text-align",dstStyle.textAlign);if($(elm).css("direction")!=dstStyle.direction)$(elm).css("direction",dstStyle.direction)},0)})(elm)})}}BV_ServerSide.Progress.End()};this.AddKlingonFontToTargetFrame=function(node){if(node.nodeType==3){node.parentNode.style.fontFamily="";var styleString=node.parentNode.getAttribute("style");if(styleString)node.parentNode.setAttribute("style",styleString+";font-family:'pIqaD' !important;");else node.parentNode.setAttribute("style","font-family:'pIqaD' !important;")}for(var i=0;i<node.childNodes.length;i++)BV_ServerSide.AddKlingonFontToTargetFrame(node.childNodes[i])};this.InitScrollSync=function(){try{var bodyStyleObj=BV_ServerSide.elemFrmSrc.contentWindow.getComputedStyle?BV_ServerSide.elemFrmSrc.contentWindow.getComputedStyle(BV_ServerSide.elemFrmSrc.contentWindow.document.body,""):BV_ServerSide.elemFrmSrc.contentWindow.document.body.currentStyle;if(bodyStyleObj)var fromDir=bodyStyleObj.direction;if(!fromDir)fromDir="ltr";BV_ServerSide.elemFrmSrc.contentWindow.document["docLanguageDir"]=fromDir;var toDir=Util.getLanguageDirStyle(LangPair.strToLang);BV_ServerSide.elemFrmTgt.contentWindow.document["docLanguageDir"]=toDir.direction;BV_ServerSide.elemFrmTgt.contentWindow.document.documentElement.style.direction=toDir.direction;BV_ServerSide.elemFrmTgt.contentWindow.document.body.style.direction=toDir.direction;if(Layout.Properties.ActiveView=="SS"||Layout.Properties.ActiveView=="TB")if(fromDir!=toDir.direction)_bv.setHorizontalScrollToEnd(BV_ServerSide.elemFrmSrc.contentWindow.document,fromDir=="rtl")}catch(oError){}};this.onFramesLoaded=function(){_bv=new Microsoft.Translator.BilingualViewer(BV_ServerSide.elemFrmSrc.contentWindow.document,BV_ServerSide.elemFrmTgt.contentWindow.document,LangPair.strFromLang,LangPair.strToLang,false,true);BV_ServerSide.InitScrollSync();var showTooltips=Layout.Properties.ActiveView=="SP"||Layout.Properties.ActiveView=="TP";_bv.setTooltips(showTooltips,showTooltips);BV_ServerSide.translateComplete();if(LangPair.strFromLang==""&&!LangPair.autoSet&&BV_ServerSide.DetectedLanguage&&BV_ServerSide.oLangNames[BV_ServerSide.DetectedLanguage]){LangPair.autoSet=true;LangPair.SetAutoDetectLanguage(BV_ServerSide.elemLblAutoDetect.innerHTML.replace("{0}",BV_ServerSide.oLangNames[BV_ServerSide.DetectedLanguage]),BV_ServerSide.DetectedLanguage)}};this.translateComplete=function(){BV_ServerSide.Progress.End();var endDate=new Date;window.BVTotalTranslationRenderTime=endDate.getTime()-window.BVTotalTranslationRenderTime.getTime();console.log("Total Time : "+window.BVTotalTranslationRenderTime)};this.SetView=function(v){Util.SetCookie("lo",v,true);Layout.Methods.SetView(v);BV_ServerSide.Go(["lo="+v])};this.Progress={Begin:function(){Layout.Methods.BeginAnimation()},End:function(){Layout.Methods.EndAnimation(false)},Update:function(n){_iProgress=n;Layout.Methods.ShowAnimationPercent(n)},Hide:function(){Layout.Methods.EndAnimation(true)}};this.ReportPage=function(){var prms=[];prms[prms.length]="agent="+encodeURIComponent(navigator.userAgent);prms[prms.length]="loc="+encodeURIComponent(navigator.language||navigator.browserLanguage);prms[prms.length]="to="+encodeURIComponent(_sTo||LangPair.strToLang);prms[prms.length]="from="+encodeURIComponent(_sFrom);prms[prms.length]="url="+encodeURIComponent(BV_ServerSide.strAddress);prms[prms.length]="lo="+encodeURIComponent(Layout.Properties.ActiveView);if(_bv){prms[prms.length]="prgrs="+encodeURIComponent(_iProgress);if(window.Microsoft.Translator.APIResponses>0)prms[prms.length]="dtc="+encodeURIComponent(_bv.getDetectedLanguage());prms[prms.length]="reqCnt="+encodeURIComponent(window.Microsoft.Translator.APIRequests);prms[prms.length]="resCnt="+encodeURIComponent(window.Microsoft.Translator.APIResponses)}else prms[prms.length]="stat="+encodeURIComponent("Page's not loaded");Util.Log("BVPages",prms);Layout.Methods.HideBVReport();Layout.Methods.ShowBVThanksReporting()};function rewriteLinks(aLinks){for(var i=0;i<aLinks.length;++i)try{if(aLinks[i].href)if(aLinks[i].href.indexOf("http://")==0||aLinks[i].href.indexOf("https://")==0){var sTmpHTML=aLinks[i].innerHTML;aLinks[i].href=BV_ServerSide.strBvRootUrl+"bvserverside/bv_serverside.aspx?from="+LangPair.strFromLang+"&to="+LangPair.strToLang+"&a="+encodeURIComponent(aLinks[i].href);aLinks[i].innerHTML=sTmpHTML;aLinks[i].onclick=function(){};aLinks[i].target="_top"}}catch(oError){}}function rewriteForms(aForms){for(var i=0;i<aForms.length;++i){aForms[i].target="_top";if(aForms[i].method==null||aForms[i].method=="undefined")continue;if(aForms[i].method.length==0||aForms[i].method.toLowerCase()=="get")rewriteForm(aForms[i])}}function rewriteForm(eForm){try{var sAddress=eForm.action?eForm.action:BV_ServerSide.strAddress;if(sAddress.indexOf("://")==-1){var mBaseMatch=BV_ServerSide.strAddress.match(/^([^:]*:\/\/[^\/]*)(\/[^\?\#]*)/),aPath=sAddress.substr(0,1)=="/"?[]:mBaseMatch[1].split("/"),mPathMatch=sAddress.match(/^([^?]*)(.*)$/),aRel=mPathMatch[1].split("/"),sQuery=mPathMatch[2];if(aPath.length>0&&aRel.length>0&&aRel[0]!=".")aPath.pop();while(aRel.length>0){var sRel=aRel.shift();switch(sRel){case ".":break;case "..":if(aPath.length)aPath.pop();break;default:aPath.push(sRel);break}}sAddress=mBaseMatch[1]+aPath.join("/")+sQuery}eForm.action=BV_ServerSide.strBvRootUrl+"bvserverside/bv_serverside.aspx";var eFrom=eForm.ownerDocument.createElement("input");eFrom.name="from";eFrom.type="hidden";eFrom.value=LangPair.strFromLang;eForm.appendChild(eFrom);var eTo=eForm.ownerDocument.createElement("input");eTo.name="to";eTo.type="hidden";eTo.value=LangPair.strToLang;eForm.appendChild(eTo);var eAddress=eForm.ownerDocument.createElement("input");eAddress.name="a";eAddress.type="hidden";eAddress.value=sAddress;eForm.appendChild(eAddress);var eSubForm=eForm.ownerDocument.createElement("input");eSubForm.name="f";eSubForm.type="hidden";eSubForm.value="1";eForm.appendChild(eSubForm);eForm.onsubmit=function(){eFrom.value=LangPair.strFromLang;eTo.value=LangPair.strToLang;eAddress.value=sAddress;eSubForm.value="1"}}catch(excp){}}function rewriteFrames(frameWindow,aFrames){var framesRewritten=false;if(aFrames.length)frameWindow.BV={onPreRender:function(frameWindow){},onPostRender:function(frameWindow){rewriteLinks(frameWindow.document.getElementsByTagName("a"));rewriteLinks(frameWindow.document.getElementsByTagName("area"));rewriteForms(frameWindow.document.getElementsByTagName("form"));rewriteFrames(frameWindow,frameWindow.document.getElementsByTagName("frame"));rewriteFrames(frameWindow,frameWindow.document.getElementsByTagName("iframe"))}};for(var i=0;i<aFrames.length;++i)try{if(aFrames[i].src&&aFrames[i].src.toLowerCase().indexOf("javascript:")==-1&&aFrames[i].src.toLowerCase().indexOf("about:")==-1){var frameDomain=aFrames[i].src.match(/http:\/\/([^:\/]+)/i);if(frameDomain&&frameDomain[1]&&BV_ServerSide.strAddress.indexOf(frameDomain[1])==-1)continue;aFrames[i].src=BV_ServerSide.strBvSandboxUrl+"proxy_serverside.ashx?h="+encodeURIComponent(this.strUrlHash)+"&a="+encodeURIComponent(BV_ServerSide.strAddress)+"&b="+encodeURIComponent(aFrames[i].src)+"&from="+encodeURIComponent(_origSrcLang)+"&to="+encodeURIComponent(_origDstLang);framesRewritten=true}}catch(excp){}return framesRewritten}function securePrompt(){return confirm(BV_ServerSide.elemLblSecureLink.innerHTML)}return this};Default=new CDefault;function CDefault(){return this}String.prototype.format=function(){for(var i=1;i<arguments.length;i++){var exp=new RegExp("\\{"+(i-1)+"\\}","gm");arguments[0]=arguments[0].replace(exp,arguments[i])}return arguments[0]};String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")};String.prototype.trimEncoded=function(){return this.replace(/^%20+|%20+$/g,"")};String.prototype.trimCr=function(){var s=this.trim();s=s.replace(/^[\n\r]+|[\n\r]+$/g,"");return s.trim()};String.prototype.startsWith=function(str,ignorecase){if(arguments.length==0)return false;if(arguments.length!=2)ignorecase=true;var me=this.trimCr();if(str.length==0||me.length<str.length)return false;var subtxt=me.substr(0,str.length);if(ignorecase){str=str.toLowerCase();subtxt=subtxt.toLowerCase()}return subtxt==str};String.prototype.containsWhiteSpace=function(){var whitespace=new RegExp(Default.Constants.ContainsWhiteSpace);return whitespace.test(this)};String.prototype.isEmpty=function(){var me=this;me=me.trimCr();me=me.replace(new RegExp(Default.Constants.OneOrMoreSpaces),"");return me.length==0};Default.Constants={StartEndWhiteSpace:/^\s+|\s+$/g,ContainsWhiteSpace:/\s+/g,ValidUrl:/^http:\/\/([A-Za-z0-9-_]+\.[A-Za-z0-9]{2,})[A-Za-z0-9-#,_%&\?\/.=]+$/i,NewLine:/\r\n/g,OneOrMoreSpaces:/\s+/g,StartsWithSpan:/$<span>/i,SingleSpace:" ",EmptyString:"",InitClass:"mttextareainit",NormClass:"mttextarea",InvisibleClass:"Invisible",PlayText:"",PlayClassName:"Play",SearchBaseUrl:"http://www.bing.com/search?form=MSTLP1&q=",EmailBaseUrl:"mailto:?body=",BvUrl:null,RTTAppID:null,BvLangToParam:null,BvLangFmParam:null,BvTargetUrl:null,VoteRating:1,BlockRating:-1,KeyCode:{ReturnKey:13,ShiftKey:16,CtrlKey:17,AltKey:18},NoHighlightKeys:{ShiftKey:16,CtrlKey:17,AltKey:18,UpArrowKey:38,DownArrowKey:40,LeftArrowKey:37,RightArrowKey:39,PrintScreenKey:44},OverlayHighlightClass:"shighlight",OutputHighlightClass:"dhighlight"};Default.Globals={RTT:false,PhraseAlignment:false,ShiftKeyDown:false,AltKeyDown:false,CtrlKeyDown:false,EscapeKeyDown:false,EscapeKeyDouble:false,PreviousText:"",PreviousFrom:"",PreviousTo:"",PreviousTextRTT:"",RTTCallIteration:0,Initialized:false,AjaxApiUserId:function(Util){var mUserId=document.cookie.match(/mstcid=([^;]+)/i);if(mUserId)mUserId=mUserId[1];else{mUserId=Math.floor(Math.random()*1e9).toString(16);document.cookie="mstcid="+mUserId+"; expires=Sun, 01-Jan-2040 01:01:01 GMT; path="+Util.GetPath()}return mUserId}(new CUtil)};var $mt=function(id){return document.getElementById(id)};Default.Language={getFrom:function(dflt){var args=arguments,s=LangPair.strFromLang;if(s.length==0&&args.length==1)s=dflt;return s.toLowerCase()},getTo:function(){return LangPair.strToLang.toLowerCase()},setFrom:function(lang){LangPair.setFromLang(lang)},setTo:function(lang){LangPair.setToLang(lang)},getDirection:function(s){var dir="ltr",arr=Default.RtlLanguages.split(",");for(var i=0;i<arr.length;i++)if(arr[i]==s){dir="rtl";break}return dir}};Default.Elements={$mt:function(e){return document.getElementById(e)},get_Body:function(){return document.getElementsByTagName("body")[0]},get_OutputText:function(){return this.$mt("TranslationOutput")},get_AjaxWaitImage:function(){return this.$mt("AjaxWaitImage")},get_SpeakButton:function(){return this.$mt("TTSLink")},get_SearchButton:function(){return this.$mt("TransSearch")},get_EmailButton:function(){return this.$mt("TransEmail")},get_InputText:function(){return this.$mt("InputText")},get_UrlInput:function(){return this.$mt("InputURL")},get_TranslateButton:function(){return this.$mt("TranslateButton")},get_AutoDetectPat:function(){return this.$mt("AutoDetectPat")},get_AutoDetectTxt:function(){return this.$mt("AutoDetectTxt")},get_ClearLink:function(){return this.$mt("Clear")},get_TdTransRating:function(){return this.$mt("TdTransRating")},get_TildeRow:function(){return this.$mt("TildeRow")},get_HmongRow:function(){return this.$mt("HmongRow")},get_OtomiRow:function(){return this.$mt("OtomiRow")},get_MayaRow:function(){return this.$mt("MayaRow")},get_UrduRow:function(){return this.$mt("UrduRow")},get_KlingonRow:function(){return this.$mt("KlingonRow")},get_WelshRow:function(){return this.$mt("WelshRow")},get_RateRow1:function(){return this.$mt("RateRow1")},get_RateRow2:function(){return this.$mt("RateRow2")},get_SearchClip:function(){return this.$mt("SearchAndClipText")},get_DictionaryTitle:function(){return this.$mt("DictionaryTitle")},get_TranslationTitle:function(){return this.$mt("TranslationTitle")},get_PlayText:function(){return this.$mt("TTSPlayText")},get_OutputCell:function(){return this.$mt("OutputTextHtmlCell")},get_SrcLinkPlaceHolder:function(){return this.$mt("InstText")},get_SrcLink:function(){return this.$mt("pnlUrlLink")},Init:function(){Initialize()},get_RTTLoading:function(){return this.$mt("RTTWaitImage")},Init:function(){Initialize()}};Default.OutputElement={"get":function(){return Default.Elements.$mt("TranslationOutput")},getInput:function(){return Default.Elements.$mt("TranslationOutputHidden")},set_ClassName:function(s){this.get().className=s},set_ClassNormal:function(){this.set_ClassName(Default.Constants.NormClass);if(LangPair.strToLang.toLowerCase()=="tlh-qaak"){$("#TranslationOutput").removeClass("mttextarea");$("#TranslationOutput").addClass("klingon")}else{$("#TranslationOutput").removeClass("klingon");$("#TranslationOutput").addClass("mttextarea")}},isRTL:function(){return "rtl"==Default.OutputElement.get().getAttribute("dir")},Tags:null,get_SpanTags:function(){var tags=[],aDivs=this.get().getElementsByTagName("div");for(var i=0;i<aDivs.length;++i){var aSpans=aDivs[i].getElementsByTagName("span");if(aSpans.length==0)tags.push(aDivs[i]);else for(var j=0;j<aSpans.length;++j){var t=aSpans[j];if(t.getAttribute("lang"))tags.push(t)}}return tags},set_Width:function(i){this.get().style.width=i+"px"},onKeyDown:function(event){var code=event.keyCode||event.which;if(event.ctrlKey&&String.fromCharCode(code).toLowerCase()=="a"){Default.OutputElement.get().focus();Default.OutputValue.selectAll();if(event.preventDefault)event.preventDefault();if(event.stopPropagation)event.stopPropagation();event.cancelBubble=true;event.returnValue=false;return false}return true},Populate:function(){var outputElem=Default.OutputElement.getInput(),outputNode=Default.OutputElement.get();outputNode.innerHTML="";var alignments=outputElem.getAttribute("mstAlign");alignments=alignments.split("|");var nodes=outputElem.childNodes,div;for(var k=0,m=0;k<nodes.length;k++){if(nodes[k].tagName.toLowerCase()=="br"){outputNode.appendChild(document.createElement("br"));continue}div=document.createElement("div");div.setAttribute("name","div["+m+"]");var alignment=alignments[m],fontElements=nodes[k].getElementsByTagName("font"),translatedText="",lang;for(var font in fontElements)if(fontElements[font].lang){lang=fontElements[font].lang;translatedText+=$(fontElements[font]).text()}if(lang)lang=lang.trim().toLowerCase();if(alignment){var aligns=alignment.split(" "),ag=[];for(var i=0;i<aligns.length;i++)ag[i]=new Default.Utils.Alignment(aligns[i]);function sortFun(a,b){return a.DstBegin>b.DstBegin||a.DstBegin==b.DstBegin&&a.DstEnd>b.DstEnd?1:a.DstBegin==b.DstBegin?0:-1}ag.sort(sortFun);for(var i=0;i<ag.length-1;i++)if(ag[i].DstBegin==ag[i+1].DstBegin){ag[i].DstEnd=ag[i+1].DstEnd;ag.splice(i+1,1);i--}var lastInd=0;for(var i=0;i<ag.length;i++){if(lastInd<ag[i].DstBegin){var node=document.createElement("span");$(node).text(translatedText.substring(lastInd,ag[i].DstBegin));div.appendChild(node)}var node=document.createElement("span"),tmp=translatedText.substring(ag[i].DstBegin,ag[i].DstEnd+1);$(node).text(translatedText.substring(ag[i].DstBegin,ag[i].DstEnd+1));tmp=tmp.trim();if(tmp.length>1||Default.Constants.Separators[lang]&&Default.Constants.Separators[lang].indexOf(tmp)==-1||!Default.Constants.Separators[lang]&&Default.Constants.Separators["en"].indexOf(tmp)==-1){node.setAttribute("id","Dst["+m+"]["+ag[i].Src+":"+ag[i].Dst+"]");node.setAttribute("_mstSrc",m+"_"+ag[i].Src);node.setAttribute("_mstDst",m+"_"+ag[i].Dst);node.setAttribute("onmouseover","Default.UI.PhraseHighlight(this)");node.setAttribute("onmouseout","Default.UI.ClearHighlight()")}div.appendChild(node);lastInd=ag[i].DstEnd+1}if(lastInd<translatedText.length){var node=document.createElement("span");$(node).text(translatedText.substring(lastInd));div.appendChild(node)}}outputNode.appendChild(div);m++}}};Default.OutputValue={"get":function(){return this._value||""},"set":function(text){var outputElem=Default.OutputElement.get();outputElem.innerHTML="";var texts=text.split(/\n/g),fontNode,divNode;for(var i=0;i<texts.length;++i){texts[i]=texts[i].trim();if(texts[i]){divNode=document.createElement("div");divNode.className="force_dir";fontNode=document.createElement("font");fontNode.appendChild(document.createTextNode(texts[i]));divNode.appendChild(fontNode);outputElem.appendChild(divNode)}else outputElem.appendChild(document.createElement("br"))}this._value=Default.Utils.GetText(outputElem)},setInput:function(text){var outputElem=Default.OutputElement.getInput();outputElem.innerHTML="";var texts=text.split(/\n/g),fontNode,divNode;for(var i=0;i<texts.length;++i){texts[i]=texts[i].trim();if(texts[i]){divNode=document.createElement("div");divNode.className="force_dir";fontNode=document.createElement("font");fontNode.appendChild(document.createTextNode(texts[i]));divNode.appendChild(fontNode);outputElem.appendChild(divNode)}else outputElem.appendChild(document.createElement("br"))}this._value=Default.Utils.GetText(outputElem)},emailText:function(){var emailText=[],aDivs=Default.OutputElement.get().getElementsByTagName("div");for(var i=0;i<aDivs.length;++i){emailText.push(encodeURIComponent(Default.Utils.GetText(aDivs[i]).replace(/\s+/g," "))+"%0D%0A");if(aDivs[i].nextSibling&&aDivs[i].nextSibling.nodeName.toLowerCase()=="br")emailText.push("%0D%0A")}emailText.push(Default.I18n.EmailFooter);emailText=emailText.join("");if(Util.MSIE){if(emailText.length>460)emailText=""}else if(emailText.length>2e3)emailText="";return emailText},sync:function(forceSync){var outputElem=Default.OutputElement.getInput(),alignments=outputElem.getAttribute("mstAlign");Default.SourceElement.getOverlay().innerHTML="";var lines=Default.SourceValue.get().split("\n");for(var i=0;i<lines.length;i++)if(lines[i].trim().length==0){lines.splice(i,1);i--}Default.SourceElement.SourceLanguage=LangPair_FromDDL.getValue();if(Default.SourceElement.SourceLanguage=="")Default.SourceElement.SourceLanguage=LangPair.elemFromLangLAD.value;if(forceSync)Default.OutputElement.get().innerHTML=outputElem.innerHTML;else if(alignments==null||alignments.replace("|","").length==0||lines.length!=alignments.split("|").length||!Default.Globals.PhraseAlignment){for(var font in outputElem.getElementsByTagName("font"))if(outputElem.getElementsByTagName("font")[font].lang){Default.OutputElement.get().innerHTML=outputElem.innerHTML;break}}else{var caretPos=Util.GetCaretPosition(Default.SourceElement.get());if(Default.SourceValue.get().match(/[\t]/))Default.SourceValue.set(Default.SourceValue.get().replace(/[\t]/g,"    "));Util.SetCaretToPosition(Default.SourceElement.get(),caretPos);if(Default.Globals.RTT)Default.Globals.PreviousTextRTT=Default.Globals.PreviousText=Default.Globals.PreviousTextRTT.replace(/[\t]/g,"    ");else Default.Globals.PreviousText=Default.SourceValue.get();Default.SourceElement.PopulateOverlay();Default.OutputElement.Populate();Default.UI.DisableHightlight=false}this._value=Default.Utils.GetText(outputElem)},markURLS:function(){var outputElem=Default.OutputElement.getInput(),exp=/(((http|https)(:\/\/))?[\w\-\S]+(\.[\w\-\S]+)*\.[a-zA-Z]{2,}(\/\S*)?)/ig,text=outputElem.innerHTML;outputElem.innerHTML=text.replace(exp,function(match,capture){if(!capture.match(/\s/))return "<a href='"+Default.Utils.GetBvUrl(capture)+"' class='bvLink' target='_blank'>"+capture+"</a>"})},pre:function(text,id){var outputElem=Default.OutputElement.get(),divNode=document.createElement("div");divNode.innerHTML=text;var divNodeOld=null;if(id){divNodeOld=document.getElementById(id);divNode.setAttribute("id",id)}if(divNodeOld)outputElem.replaceChild(divNodeOld,divNode);else outputElem.insertBefore(divNode,outputElem.firstChild)},add:function(text,id){var outputElem=Default.OutputElement.get(),divNode=document.createElement("div");divNode.innerHTML=text;var divNodeOld=null;if(id){divNodeOld=document.getElementById(id);divNode.setAttribute("id",id)}if(divNodeOld)outputElem.replaceChild(divNodeOld,divNode);else outputElem.appendChild(divNode)},selectAll:function(){var selection,range;if(!Util.MSIE){selection=window.getSelection();range=selection.getRangeAt(0);range.selectNodeContents(Default.OutputElement.get());selection.removeAllRanges();selection.addRange(range)}else{selection=document.selection;selection.clear();range=selection.createRange();range.moveToElementText(Default.OutputElement.get());range.select()}},addHyperLink:function(text){text=Default.Utils.CollapseString(text);var outputElem=Default.OutputElement.getInput();outputElem.innerHTML="";var bvLink=document.createElement("a");bvLink.className="bvLink";var span=document.createElement("span");span.innerHTML=Default.Utils.htmlEncode(text);bvLink.appendChild(span);var encodedText=encodeURIComponent(text);if(encodedText.length<200){bvLink.setAttribute("target","_blank");bvLink.setAttribute("href",Default.Utils.GetBvUrl(encodedText))}else{bvLink.setAttribute("href","javascript:void(0)");bvLink.setAttribute("onclick","Default.Utils.SendUrlTranslationViaPost('"+encodedText+"')")}outputElem.appendChild(bvLink);this.sync(true)},hideOptions:function(){$mt("TransSearch").style.visibility="hidden";$mt("TransEmail").style.visibility="hidden";$mt("TTSLink").style.visibility="hidden"}};Default.SourceElement={SourceLanguage:"","get":function(){return Default.Elements.$mt("InputText")},getOverlay:function(){return document.getElementById("Overlay")},resetOverlay:function(){Default.SourceElement.getOverlay().innerHTML="";Default.UI.DictionaryEntry=false;Default.OutputElement.getInput().setAttribute("mstAlign","")},UpdateOverlayDimensions:function(){var overlay=Default.SourceElement.getOverlay(),inputText=Default.SourceElement.get(),attr=["font-family","font-size","font-weight","font-style","direction","margin-top","margin-right","margin-bottom","margin-left","padding-top","padding-right","padding-bottom","padding-left","border-top-width","border-right-width","border-bottom-width","border-left-width","overflow-x","overflow-y"];for(var i=0;i<attr.length;i++)$(overlay).css(attr[i],$(inputText).css(attr[i]));$(overlay).width(Default.SourceElement.GetOverlayWidth());if($.browser.msie&&$.browser.version<9)$(overlay).css("white-space","pre-line")},set_ClassName:function(s){this.get().className=s},set_Height:function(i){this.get().setAttribute("height",i+"px")},set_Width:function(i){this.get().setAttribute("width",i+"px")},PopulateOverlay:function(){var alignInfo;if((alignInfo=Default.OutputElement.getInput().getAttribute("mstalign"))==null)return;var lang=LangPair_FromDDL.getValue();if(lang=="")lang=LangPair.elemFromLangLAD.value;var overlay=Default.SourceElement.getOverlay();overlay.style.direction=Default.SourceElement.get().style.direction;overlay.innerHTML="";var alignments=Default.OutputElement.getInput().getAttribute("mstalign").split("|"),lines=Default.SourceElement.get().value.split("\n"),aligns=[];for(var k=0;k<alignments.length;k++){var ag=alignments[k].split(" ");for(var j=0;j<ag.length;j++)ag[j]=new Default.Utils.Alignment(ag[j]);function sortFun(p1,p2){return p1.SrcBegin>p2.SrcBegin||p1.SrcBegin==p2.SrcBegin&&p1.SrcEnd>p2.SrcEnd?1:p1.SrcBegin==p2.SrcBegin?0:-1}ag.sort(sortFun);for(var j=0;j<ag.length-1;j++)if(ag[j].SrcBegin==ag[j+1].SrcBegin){ag.splice(j+1,1);j--}aligns.push(ag)}for(var k=0,m=0;k<lines.length;k++){lines[k]=lines[k].replace("\r","");if(lines[k].trim().length==0)continue;var text=lines[k],regex=/^([ ]*)(.*)$/,match=regex.exec(text),inc=match[1].length,lastInd=match[1].length;for(var i=0;i<aligns[m].length;i++){aligns[m][i].SrcBegin+=inc;aligns[m][i].SrcEnd+=inc}for(var j=0;j<aligns[m].length;j++){inc=0;var srcBegin=aligns[m][j].SrcBegin,srcEnd=aligns[m][j].SrcEnd,wt=-1;for(var i=lastInd;i<=srcBegin;i++){if(text[i]==" ")wt++;if(text[i]!=" "||i==srcBegin){if(wt>0){inc+=wt;srcBegin+=wt}if(text[i]!=" ")wt=-1;else wt=0}}srcEnd+=inc;wt=-1;for(var i=srcBegin;i<=srcEnd;i++){if(text[i]==" ")wt++;if(text[i]!=" "||i==srcEnd){if(wt>0){inc+=wt;srcEnd+=wt}if(text[i]!=" ")wt=-1;else wt=0}}aligns[m][j].SrcBegin=srcBegin;aligns[m][j].SrcEnd=srcEnd;for(var i=j+1;i<aligns[m].length;i++){aligns[m][i].SrcBegin+=inc;aligns[m][i].SrcEnd+=inc}lastInd=aligns[m][j].SrcEnd+1}m++}for(var m=0,k=0;m<aligns.length;m++){while(lines[k].trim().length==0)k++;for(var i=0;i<aligns[m].length;i++){if(i+1>=aligns[m].length)break;if(aligns[m][i].DstBegin==aligns[m][i+1].DstBegin&&aligns[m][i].SrcEnd+1<=aligns[m][i+1].SrcBegin){aligns[m][i].SrcEnd=aligns[m][i+1].SrcEnd;aligns[m].splice(i+1,1);i--}else if(aligns[m][i].DstBegin==aligns[m][i+1].DstBegin&&aligns[m][i].SrcEnd+2==aligns[m][i+1].SrcBegin&&lines[k][aligns[m][i].SrcEnd+1]==" "){aligns[m][i].SrcEnd=aligns[m][i+1].SrcEnd;aligns[m].splice(i+1,1);i--}}}var noHightLightIds=0;for(var k=0,m=0;k<lines.length;k++){if(lines[k].trim().length==0){overlay.appendChild(document.createElement("br"));continue}var div=document.createElement("div"),lastInd=0;for(var j=0;j<aligns[m].length;j++){var node=document.createElement("span");if($.browser.msie&&$.browser.version<9)node.innerText=lines[k].substring(lastInd,aligns[m][j].SrcBegin);else $(node).text(lines[k].substring(lastInd,aligns[m][j].SrcBegin));$(node).attr("id","nohighlight["+noHightLightIds+"]");noHightLightIds++;div.appendChild(node);node=document.createElement("span");var tmp=lines[k].substring(aligns[m][j].SrcBegin,aligns[m][j].SrcEnd+1);if($.browser.msie&&$.browser.version<9)node.innerText=lines[k].substring(aligns[m][j].SrcBegin,aligns[m][j].SrcEnd+1);else $(node).text(lines[k].substring(aligns[m][j].SrcBegin,aligns[m][j].SrcEnd+1));if(tmp.length>1||Default.Constants.Separators[lang]&&Default.Constants.Separators[lang].indexOf(tmp)==-1||!Default.Constants.Separators[lang]&&Default.Constants.Separators["en"].indexOf(tmp)==-1){node.setAttribute("id","Src["+m+"]["+aligns[m][j].Src+":"+aligns[m][j].Dst+"]");node.setAttribute("_mstSrc",m+"_"+aligns[m][j].Src);node.setAttribute("_mstDst",m+"_"+aligns[m][j].Dst);node.setAttribute("onmouseover","Default.UI.PhraseHighlight(this)");node.setAttribute("onmouseout","Default.UI.ClearHighlight()")}else{$(node).attr("id","noHighlightId["+noHightLightIds+"]");noHightLightIds++}div.appendChild(node);lastInd=aligns[m][j].SrcEnd+1}if(lastInd<lines[k].length){var node=document.createElement("span");$(node).text(lines[k].substring(lastInd));div.appendChild(node)}overlay.appendChild(div);m++}setTimeout(Default.SourceElement.UpdateOverlayDimensions,200)},GetOverlayWidth:function(){var inputText=Default.SourceElement.get(),style;if(window.getComputedStyle)style=window.getComputedStyle(inputText);else style=inputText.currentStyle;if($.browser.msie&&$.browser.version<9)return inputText.offsetWidth-parseInt($(inputText).css("padding-right"));else if($.browser.mozilla){var diff=Math.ceil(parseFloat(style.getPropertyValue("width"))-parseInt(style.getPropertyValue("width")));return parseInt(style.getPropertyValue("width"))+parseInt(style.getPropertyValue("padding-right"))+diff+1}else return $(inputText).innerWidth()}};Default.SourceValue={"get":function(){return Default.SourceElement.get().value},"set":function(text){var e=Default.SourceElement.get();e.value=text}};WaitImage={Show:function(){Default.OutputElement.set_ClassName(Default.Constants.InvisibleClass);Default.Elements.get_AjaxWaitImage().style.visibility="visible"},ShowRTT:function(){Default.Elements.get_RTTLoading().style.visibility="visible"},Hide:function(){Default.OutputElement.set_ClassNormal();Default.Elements.get_AjaxWaitImage().style.visibility="hidden"},HideRTT:function(){Default.Elements.get_RTTLoading().style.visibility="hidden"}};Default.Utils={isExplorer:function(){return window.navigator.userAgent.toUpperCase().indexOf("MSIE")>-1},CollapseString:function(s){s=s.trimCr();s=s.replace(new RegExp(Default.Constants.OneOrMoreSpaces),"");return s},ValidateInput:function(){var s=Default.SourceValue.get();if(s.isEmpty())return false;if(!s.match(/[a-zA-Z0-9\xC0-\uFFFF]/))return false;return true},GetBvUrl:function(url){with(Default)return Constants.BvUrl+"?"+Constants.BvLangFmParam+"="+Language.getFrom()+"&"+Constants.BvLangToParam+"="+Language.getTo()+"&"+Constants.BvTargetUrl+"="+url},FindPosition:function(obj){var curleft=0,curtop=0;if(obj&&obj.offsetParent)do{curleft+=obj.offsetLeft;curtop+=obj.offsetTop}while(obj=obj.offsetParent);return {x:curleft,y:curtop}},ToggleClassName:function(elem,className){var flag=0;if(elem&&elem.className!==null&&elem.className!==undefined)if(elem.className.match(className)){elem.className=elem.className.replace(className,"");flag=-1}else{elem.className+=className;flag=1}return flag},AddClassName:function(elem,className){if(elem&&elem.className!==null&&elem.className!==undefined){var elemClassName=" "+elem.className.trim();className=" "+className.trim();if(!elemClassName.match(className)){elemClassName+=className;elem.className=elemClassName.trim()}return true}else return false},RemoveClassName:function(elem,className){if(elem&&elem.className!==null&&elem.className!==undefined){className=className.trim();var elemClassName=" "+elem.className.trim();elem.className=elemClassName.replace(className,"").trim();return true}else return false},SortTranslations:function(a,b){if(a.Rating<b.Rating)return 1;else if(a.Rating>b.Rating)return -1;else if(a.Count<b.Count)return 1;else if(a.Count>b.Count)return -1;else if(a.TranslatedText>b.TranslatedText)return 1;else if(a.TranslatedText<b.TranslatedText)return -1;else return 0},GetText:function(elem){var text="";if(elem)text=elem.innerText||elem.textContent||"";return text},SetText:function(elem,text){if(elem)if(elem.innerText!==undefined)elem.innerText=text;else elem.textContent=text},htmlEncode:function(value){var div=document.createElement("div");Default.Utils.SetText(div,value);return div.innerHTML},htmlEncodeKeepWS:function(value){return String(value).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},SendUrlTranslationViaPost:function(url){params=[];with(Default){params[Constants.BvLangFmParam]=Language.getFrom();params[Constants.BvLangToParam]=Language.getTo();params[Constants.BvTargetUrl]=url}Util.SendPostRequest(Default.Constants.BvUrl,params,"_blank")},Alignment:function(str){var tmp=str.split("-");this.Src=tmp[0];this.Dst=tmp[1];var src=tmp[0].split(":"),dst=tmp[1].split(":");this.DstBegin=parseInt(dst[0]);this.DstEnd=parseInt(dst[1]);this.SrcBegin=parseInt(src[0]);this.SrcEnd=parseInt(src[1])}};Default.UI={TimerId:null,SupressFocus:false,SupportedTTSLanguages:null,DisablePhraseAlignment:false,DictionaryEntry:false,SetVisibility:function(success){var isIE=Default.Utils.isExplorer(),visibility=success?"visible":"hidden";with(Default.Elements){get_SearchButton().style.visibility=visibility;get_EmailButton().style.visibility=visibility;get_TdTransRating().style.visibility=visibility;get_ClearLink().style.visibility=visibility;get_SpeakButton().style.visibility="hidden";if(success&&T2S.Enabled){var ttsLanguages=this.SupportedTTSLanguages.split(",");for(var i=0;i<ttsLanguages.length;i++)if(Default.Language.getTo()==ttsLanguages[i]){get_SpeakButton().style.visibility="visible";break}}if(LangPair.strFromLang.toLowerCase()=="tlh-qaak"){$("#InputText").removeClass("mttextarea");$("#InputText").addClass("klingon")}else{$("#InputText").removeClass("klingon");$("#InputText").addClass("mttextarea")}if(LangPair.strToLang.toLowerCase()=="tlh-qaak"){$("#TranslationOutput").removeClass("mttextarea");$("#TranslationOutput").addClass("klingon")}else{$("#TranslationOutput").removeClass("klingon");$("#TranslationOutput").addClass("mttextarea")}if(Default.Service.HasTransError){get_SpeakButton().style.visibility="hidden";get_SearchButton().style.visibility="hidden";get_EmailButton().style.visibility="hidden";get_ClearLink().style.visibility="hidden"}}},HideShowHmong:function(show){Default.Elements.get_HmongRow().style.display=show?"block":"none"},HideShowMaya:function(show){Default.Elements.get_MayaRow().style.display=show?"block":"none"},HideShowOtomi:function(show){Default.Elements.get_OtomiRow().style.display=show?"block":"none"},HideShowTilde:function(show){Default.Elements.get_TildeRow().style.display=show?"block":"none"},HideShowUrdu:function(show){Default.Elements.get_UrduRow().style.display=show?"block":"none"},HideShowKlingon:function(show){Default.Elements.get_KlingonRow().style.display=show?"block":"none"},HideShowWelsh:function(show){Default.Elements.get_WelshRow().style.display=show?"block":"none"},SetDisabled:function(isDisabled){with(Default.Elements){get_SearchButton().removeAttribute("disabled");get_EmailButton().removeAttribute("disabled");get_SpeakButton().removeAttribute("disabled");get_TranslateButton().removeAttribute("disabled");if(isDisabled){get_SearchButton().setAttribute("disabled",true);get_EmailButton().setAttribute("disabled",true);get_SpeakButton().setAttribute("disabled",true);get_TranslateButton().setAttribute("disabled",true)}}},SetPreTransLayout:function(){Default.UI.SetDisabled(false);Default.UI.SetVisibility(false)},SetPostTransLayout:function(success){Default.UI.SetVisibility(success);Default.UI.SetTextDimensions();Default.UI.SetDisabled(false);Default.UI.ShowFBConfirm(false);if(success){Default.OutputElement.get().setAttribute("dir",Default.Language.getDirection(Default.Language.getTo()));Default.Elements.$mt("InputTextHtmlCell").setAttribute("dir",Default.Language.getDirection(Default.Language.getFrom(Default.Service.DetectedLang)));if(!Default.Globals.RTT)Default.UI.SetCursorToEnd()}},ClearAll:function(focus){Default.UI.DisableHightlight=true;Default.SourceElement.resetOverlay();this.SetPreTransLayout();Default.SourceValue.set("");Default.OutputValue.set("");Default.Elements.get_SearchClip().value="";this.SetTextDimensions();if(focus)this.SetCursorToEnd();Default.Elements.get_ClearLink().style.visibility="hidden";var srclink=Default.Elements.get_SrcLink();if(srclink)srclink.style.display="none";Default.Elements.get_SrcLinkPlaceHolder().style.display="";this.SupressFocus=false;if(T2S)T2S.SetNewTranslation()},LangChanged:function(){Default.Elements.$mt("InputTextHtmlCell").setAttribute("dir",Default.Language.getDirection(Default.Language.getFrom(Default.Service.DetectedLang)));Default.UI.HideShowTilde(Default.Language.getTo()=="lv"||Default.Language.getFrom()=="lv");Default.UI.HideShowHmong(Default.Language.getTo()=="mww"||Default.Language.getFrom()=="mww");Default.UI.HideShowMaya(Default.Language.getTo()=="yua"||Default.Language.getFrom()=="yua");Default.UI.HideShowOtomi(Default.Language.getTo()=="otq"||Default.Language.getFrom()=="otq");Default.UI.HideShowUrdu(Default.Language.getTo()=="ur"||Default.Language.getFrom()=="ur");Default.UI.HideShowKlingon(Default.Language.getTo()=="tlh"||Default.Language.getFrom()=="tlh"||Default.Language.getTo()=="tlh-qaak"||Default.Language.getFrom()=="tlh-qaak");Default.UI.HideShowWelsh(Default.Language.getTo()=="cy"||Default.Language.getFrom()=="cy")},TextInputFocus:function(){Default.Globals.EscapeKeyDouble=false;Default.Globals.EscapeKeyDown=false},TextInputKeyDown:function(e){with(Default){if(!e)e=window.event;if(e.keyCode==Constants.KeyCode.ShiftKey)Globals.ShiftKeyDown=true}},TextInputKeyUp:function(e){with(Default){if(!e)e=window.event;var code=e.keyCode||e.which,isSpecialKey=false;for(var key in Constants.NoHighlightKeys)if(code==Constants.NoHighlightKeys[key]){isSpecialKey=true;break}if(code==Constants.KeyCode.ReturnKey&&!Globals.ShiftKeyDown){if(Default.Globals.Initialized&&(UI.SourceHasChanged(true)||Default.Globals.RTT))Service.Translate()}else if(code==Constants.KeyCode.ShiftKey)Globals.ShiftKeyDown=false;else if(code==Constants.KeyCode.CtrlKey)Globals.CtrlKeyDown=false;else if(code==Constants.KeyCode.AltKey)Globals.AltKeyDown=false;else if(!isSpecialKey){Default.UI.SetTextDimensions();Default.UI.ClearHighlight()}}},SetTextDimensions:function(){with(Default.Elements){var displayHeight=186,inputElem=Default.SourceElement.get(),outputElem=Default.OutputElement.get();if(outputElem.offsetHeight&&outputElem.offsetHeight>displayHeight)displayHeight=outputElem.offsetHeight+3;inputElem.style.height=displayHeight+"px";if(inputElem.scrollHeight>inputElem.offsetHeight)inputElem.style.height=inputElem.scrollHeight+"px"}},SetCursorToEnd:function(){if(Default.UI.SupressFocus)return;var len=Default.SourceValue.get().length;if(Default.SourceElement.get().setSelectionRange){Default.SourceElement.get().focus();Default.SourceElement.get().setSelectionRange(len,len)}else if(Default.SourceElement.get().createTextRange){var range=Default.SourceElement.get().createTextRange();range.collapse(true);range.moveEnd("character",len,len);range.moveStart("character",len,len);range.select()}},SourceHasChanged:function(suppressUpdate){with(Default){if(Default.SourceValue.get().isEmpty())return false;var hasChange=false;if(Default.SourceValue.get().trim().length==0)hasChange=true;else{var str1=Utils.CollapseString(Default.SourceValue.get()),str2=Utils.CollapseString(Globals.PreviousText),lpChanged=Language.getFrom()!=Globals.PreviousFrom||Language.getTo()!=Globals.PreviousTo;hasChange=str1!=str2||lpChanged||this.LineCountChanged()}if(!suppressUpdate){Globals.PreviousText=Default.SourceValue.get();Globals.PreviousFrom=Language.getFrom();Globals.PreviousTo=Language.getTo()}return hasChange}},LineCountChanged:function(){var lineCount1=0,lineCount2=0,arry1=Default.SourceValue.get().split(Default.Constants.NewLine),arry2=Default.Globals.PreviousText.split(Default.Constants.NewLine),i;for(i=0;i<arry1.length;i++)if(arry1[i].isEmpty()==false)lineCount1++;for(i=0;i<arry2.length;i++)if(arry2[i].isEmpty()==false)lineCount2++;return lineCount1!=lineCount2},ShowFBConfirm:function(show){with(Default.Elements){get_RateRow1().style.display=show?"none":"block";get_RateRow2().style.display=show?"block":"none"}},PhraseHighlight:function(obj){Default.UI.ClearHighlight();var lang=LangPair_FromDDL.getValue();if(lang=="")lang=LangPair.elemFromLangLAD.value;if(!Default.Globals.PhraseAlignment||Default.UI.DisableHightlight||Default.UI.DictionaryEntry||Default.SourceElement.SourceLanguage!=lang)return;if(Default.Globals.PreviousText.trim()!=Default.SourceValue.get().trim())return;if(Default.Globals.PreviousText!=Default.SourceValue.get())Default.SourceElement.PopulateOverlay();var params=obj.getAttribute("_mstSrc").split("_"),divNum=params[0],src=params[1];params=obj.getAttribute("_mstDst").split("_");var dst=params[1];$(Default.SourceElement.getOverlay()).children("div").children("[_mstDst='"+divNum+"_"+dst+"']").addClass(Default.Constants.OverlayHighlightClass);$(Default.OutputElement.get()).children("div").children("[_mstDst='"+divNum+"_"+dst+"']").addClass(Default.Constants.OutputHighlightClass);$(Default.SourceElement.getOverlay()).children("div").children("[_mstSrc='"+divNum+"_"+src+"']").addClass(Default.Constants.OverlayHighlightClass);$(Default.OutputElement.get()).children("div").children("[_mstSrc='"+divNum+"_"+src+"']").addClass(Default.Constants.OutputHighlightClass);Default.SourceElement.getOverlay().style.visibility="visible"},ClearHighlight:function(){if(!Default.Globals.PhraseAlignment)return;$(Default.SourceElement.getOverlay()).children("div").children("."+Default.Constants.OverlayHighlightClass).removeClass(Default.Constants.OverlayHighlightClass);$(Default.OutputElement.get()).children("div").children("."+Default.Constants.OutputHighlightClass).removeClass(Default.Constants.OutputHighlightClass);Default.SourceElement.getOverlay().style.visibility="hidden"},IsMobileDevice:function(){var userAgent=navigator.userAgent||navigator.vendor||window.opera;return /(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od|ad)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(userAgent.substr(0,4))},resetUIState:function(){Default.Service.HasTransError=false;Default.Service.TransComplete=false;Default.Service.Dictionary.Translation=""}};Default.Init=function(){Default.Elements.Init();LangPair.Init();LangPair.OnChangeHandlerMethod=Default.UI.LangChanged;var eRewardsLink=document.getElementById("sw_meCtrl");if(eRewardsLink&&eRewardsLink.href)eRewardsLink.href=eRewardsLink.href.replace("microsofttranslator.com","bing.com").replace("microsofttranslator-int.com","bing-int.com");Default.Globals.Initialized=true};Default.Service={DictText:"",Success:false,LangTo:null,LangFrom:null,TimeoutId:"",HasTransError:false,TransComplete:false,Dictionary:{IsActive:false,SupportedLP:"",MaxWords:4,MaxOverride:"",Translation:"",ExceedsMax:function(from,txt){var max=Default.Service.Dictionary.MaxWords,override=Default.Service.Dictionary.MaxOverride.split(",");for(var i=0;i<override.length;i++){var pair=override[i].split(":");if(pair.length==2){var lang=pair[0],len=parseInt(pair[1]);if(from.toLowerCase()==lang.toLowerCase()){max=len;break}}}if(txt.length>32||txt.split(/\s+/).length>max)return true;else return false},SupportsLangPair:function(from,to){var languages=Default.Service.Dictionary.SupportedLP.split(","),supported=false;if(from.indexOf("-")!=-1)from=from.substr(0,from.indexOf("-"));if(to.indexOf("-")!=-1)to=to.substr(0,to.indexOf("-"));var lp=from+"-"+to;for(var i=0;i<languages.length;i++)if(lp.toLowerCase()==languages[i].toLowerCase()){supported=true;break}return supported},TryOutputResults:function(){if(Default.Service.TransComplete)if(Default.Service.Dictionary.FromLang==LangPair.strFromLang||Default.Service.Dictionary.FromLang==LangPair.strFromLangADL){if(Default.Service.Dictionary.Translation.length>0){var s=Default.Service.Dictionary.Translation.split("{0}");if(s.length==2){Default.OutputValue.pre(s[0],"_outputHeader");Default.OutputValue.add(s[1],"_dictContent");Default.UI.SetTextDimensions()}return true}}else if(LangPair.strFromLangADL)Default.Service.CallDictionary();return false}},DetectedLang:"en",HandleError:function(){Default.UI.SetPostTransLayout(false);Default.Elements.get_ClearLink().style.visibility="visible";Default.UI.SetTextDimensions()},CheckForUrl:function(text){var url=text.trimCr();if(url.match(/\s/))return false;if(url.match(/[:][\/][\/]/)){if(url.length<200)document.location=Default.Utils.GetBvUrl(url);else Default.Utils.SendUrlTranslationViaPost(url);return true}var domainMatch=url.match(/^[\w\-]+(\.[\w\-]+)*\.[a-zA-Z]{2,}(\/.*)?\s{0,}$/);if(domainMatch){if(url.length<200)document.location=Default.Utils.GetBvUrl(url);else Default.Utils.SendUrlTranslationViaPost(url);return true}return false},checkForUrlWithoutRedirect:function(text){var url=text.trimCr();if(url.match(/\s/))return false;if(url.match(/[:][\/][\/]/))return true;var domainMatch=url.match(/^[\w\-]+(\.[\w\-]+)*\.[a-zA-Z]{2,}(\/.*)?\s{0,}$/);if(domainMatch)return true;return false},ErrorHandler:function(){alert("an error occurred.")},CallDictionary:function(){try{Default.Service.Dictionary.FromLang=LangPair.strFromLang||Default.Service.DetectedLang||LangPair.strFromLangADL;if(Default.Service.Dictionary.IsActive){var detectedLang="";if(null!=Default.Service.DetectedLang)detectedLang=Default.Service.DetectedLang;var srcText=Default.SourceValue.get().trimCr(),from=Default.Language.getFrom(detectedLang),to=Default.Language.getTo();if(false==Default.Service.Dictionary.ExceedsMax(from,srcText))if(Default.Service.Dictionary.SupportsLangPair(from,to)){var dictScript=document.createElement("script");dictScript.src=Default.Service.Dictionary.BaseUrl+"?from="+from+"&to="+to+"&text="+encodeURIComponent(srcText)+"&oncomplete=onDictComplete";document.body.appendChild(dictScript)}}}catch(e){}},OutputResults:function(){if(Default.OutputValue.get().trim().length==0)Default.Service.HasTransError=true;if(Default.Service.HasTransError){Default.Service.TransComplete=true;Default.UI.SetPostTransLayout(false);return}Default.Elements.get_SrcLinkPlaceHolder().innerHTML=Default.Constants.SrcLinkText;Default.Service.DetectedLang=Default.Language.getFrom("");if(Default.Service.DetectedLang.length==0)if(undefined!=Default.Service.MSTranslator.detectedLanguage&&null!=Default.Service.MSTranslator.detectedLanguage)Default.Service.DetectedLang=Default.Service.MSTranslator.detectedLanguage;Default.Service.SetLangCodes();if(LangPair.strFromLang==""&&Default.Service.DetectedLang.length>0&&Default.Constants.LangNames[Default.Service.DetectedLang]){LangPair.autoSet=true;LangPair.SetAutoDetectLanguage(Default.Elements.get_AutoDetectPat().value.replace("{0}",Default.Constants.LangNames[Default.Service.DetectedLang]),Default.Service.DetectedLang);if(Default.Service.DetectedLang==LangPair.strToLang&&LangPair.mrulToLangs)for(var mrul=0;mrul<LangPair.mrulToLangs.length;mrul++)if(LangPair.mrulToLangs[mrul]!=Default.Service.DetectedLang){Default.Language.setTo(LangPair.mrulToLangs[mrul]);Default.Service.Translate();return}}Default.Utils.SetText(Default.Elements.get_SearchClip(),Default.Utils.GetText(Default.OutputElement.get()));Default.Service.TransComplete=true;Default.OutputValue.sync();var searchQuery=encodeURIComponent(Default.OutputValue.get().replace(/\s+/g," ")).replace(/%20/g,"+");if(searchQuery.length>1950)searchQuery=searchQuery.substr(0,searchQuery.indexOf("%",1950));Default.Elements.get_SearchButton().href=Default.Constants.SearchBaseUrl+searchQuery;var emailText=Default.OutputValue.emailText(),emailBtnElem=Default.Elements.get_EmailButton();if(emailText){emailBtnElem.href=Default.Constants.EmailBaseUrl+emailText;emailBtnElem.style.display=""}else emailBtnElem.style.display="none";Default.UI.SetPostTransLayout(true);Default.Service.Dictionary.TryOutputResults()},FixReturns:function(s){var fix=s.replace(new RegExp("^[\r\n]{1,}","gi"),"");fix=fix.replace(new RegExp("[\r\n]{2,}$","gi"),"\r\n");return fix.replace(new RegExp("[\r\n]{3,}","gi"),"\r\n\r\n")},SetLangCodes:function(){return Default.Constants.LangNames},SetDictionaryResult:function(dictTrans){Default.Service.Dictionary.Translation="";if(null==dictTrans||dictTrans.trim().length==0)return;var tranTitle='<div class="TranslationHeader">'+Default.Elements.get_TranslationTitle().value+"</div>",dictTitle='<div class="DictionaryHeader">'+Default.Elements.get_DictionaryTitle().value+"</div>";Default.Service.Dictionary.Translation=tranTitle+"{0}"+dictTitle+dictTrans;Default.Service.Dictionary.TryOutputResults();Default.UI.DictionaryEntry=true},MSTranslator:null,GetTranslation:function(){try{Default.UI.DisableHightlight=true;Default.UI.DictionaryEntry=false;if(!Default.Globals.RTT)WaitImage.Show();var txt=Default.SourceValue.get();if(txt.match(/^[\n\r]+/))txt=txt.replace(/^[\n\r]+/g,"");if(txt.length>Default.Constants.MaxTransChars)txt=txt.substr(0,Default.Constants.MaxTransChars);Default.OutputValue.setInput(txt);if(Default.Service.MSTranslator&&Default.Service.MSTranslator.cancel)try{Default.Service.MSTranslator.cancel()}catch(e){}Default.Service.MSTranslator=Microsoft.Translator.Translate(Default.Constants.AjaxApiAppId,Default.OutputElement.getInput(),Default.Language.getFrom(""),Default.Language.getTo(),function(){WaitImage.Hide();Default.Service.OutputResults();WaitImage.HideRTT()},function(error){WaitImage.Hide();Default.Service.TranslationError(error);WaitImage.HideRTT()},14000);Default.Service.MSTranslator.showTooltips=false;Default.Service.MSTranslator.showHighlight=false;Default.Service.CallDictionary()}catch(e){}},GetTranslationRTT:function(){try{if(!Default.Globals.RTT)WaitImage.Show();Default.SourceElement.resetOverlay();var txt=Default.SourceValue.get();if(txt.match(/^[\n\r]+/))txt=txt.replace(/^[\n\r]+/g,"");if(txt.length>Default.Constants.MaxTransChars)txt=txt.substr(0,Default.Constants.MaxTransChars);Default.OutputValue.setInput(txt);Default.Service.MSTranslator=Microsoft.Translator.Translate(Default.Constants.RTTAppID,Default.OutputElement.getInput(),Default.Language.getFrom(""),Default.Language.getTo(),function(){Default.Globals.RTTCallIteration=1;Default.Service.OutputResults();WaitImage.HideRTT()},function(error){Default.Service.TranslationError(error);WaitImage.HideRTT()},14000);Default.Service.MSTranslator.showTooltips=false;Default.Service.MSTranslator.showHighlight=false;Default.Service.CallDictionary()}catch(e){}},Translate:function(suppressRedirect){if(Default.Globals.Initialized==false){setTimeout(function(){Default.Service.Translate(suppressRedirect)},50);return}T2S.SetNewTranslation();Default.UI.resetUIState();Default.SourceElement.resetOverlay();if(!Default.Globals.RTT&&!LangPair.strFromLang)LangPair.SetAutoDetectLanguage(Default.Elements.get_AutoDetectTxt().value,"");T2S.SetPreTrans();with(Default){if(!Utils.ValidateInput())return;try{if(!suppressRedirect&&Service.CheckForUrl(SourceValue.get()))return;if(Default.Globals.RTT){Globals.PreviousText=Default.SourceValue.get();Globals.PreviousFrom=Language.getFrom();Globals.PreviousTo=Language.getTo()}if(suppressRedirect===0)WaitImage.Show();Service.GetTranslation()}catch(error){UI.SetDisabled(false);UI.SetPostTransLayout(false);if(!Default.Globals.RTT)WaitImage.Hide();alert(error.description)}}},TranslateRTT:function(forceTranslation){Default.UI.resetUIState();if(!Default.Globals.RTT&&!LangPair.strFromLang)LangPair.SetAutoDetectLanguage(Default.Elements.get_AutoDetectTxt().value,"");WaitImage.Hide();with(Default){if(!Utils.ValidateInput()){Globals.PreviousTextRTT="";Default.OutputElement.get().innerHTML="";Default.UI.SetTextDimensions();return}try{var prevFromLang=Globals.PreviousFrom,prevToLang=Globals.PreviousTo;Globals.PreviousFrom=Language.getFrom();Globals.PreviousTo=Language.getTo();if(Default.SourceValue.get().trim()!=Globals.PreviousTextRTT.trim()||prevFromLang!=Globals.PreviousFrom||prevToLang!=Globals.PreviousTo||forceTranslation){WaitImage.ShowRTT();Globals.PreviousTextRTT=Default.SourceValue.get();if(Service.checkForUrlWithoutRedirect(SourceValue.get())){Default.OutputValue.addHyperLink(SourceValue.get());Default.OutputValue.hideOptions();WaitImage.HideRTT();return}if(Default.Globals.RTTCallIteration%2!=0)if(Default.Service.MSTranslator&&Default.Service.MSTranslator.cancel){try{Default.Service.MSTranslator.cancel()}catch(e){}Default.Globals.RTTCallIteration++}Service.GetTranslationRTT()}}catch(error){UI.SetDisabled(false);UI.SetPostTransLayout(false);if(!Default.Globals.RTT)WaitImage.Hide();console.log(error)}}},TranslationError:function(error){var errorChunks=error.split(":"),errorName=errorChunks[0],errorID=errorChunks[3];switch(errorName){case "ArgumentOutOfRangeException":if(!Default.Language.getFrom()&&Default.SourceValue.get().length>=10)Default.Elements.get_SrcLinkPlaceHolder().innerHTML=Default.Constants.AutoDetectFailureMessage;else Default.Elements.get_SrcLinkPlaceHolder().innerHTML=Default.Constants.SrcLinkText;break;default:Default.Elements.get_SrcLinkPlaceHolder().innerHTML=Default.Constants.SrcLinkText}},DictonaryComplete:function(e){if(e){Default.Service.DictText=e;if(Default.OutputValue.get().trim().length>0&&e.length>0)Default.Service.OutputResults()}}};Default.Rating={SubmitRating:function(iRating){Default.UI.ShowFBConfirm(true);try{var oText=Default.SourceValue.get(),tText=Default.OutputValue.get(),fromLang=Default.Language.getFrom()||LangPair.strFromLangADL,toLang=Default.Language.getTo();Microsoft.Translator.AddTranslation(Default.Constants.AjaxApiAppId,oText,tText,fromLang,toLang,iRating,null,null,Default.Globals.AjaxApiUserId)}catch(e){}},SubmitSentanceRating:function(iRating,iText,tText){try{var fromLang=Default.Language.getFrom()||LangPair.strFromLangADL,toLang=Default.Language.getTo();Microsoft.Translator.AddTranslation(Default.Constants.CTFApiAppId,iText,tText,fromLang,toLang,iRating,null,null,Default.Globals.AjaxApiUserId)}catch(e){}}};window.onDictComplete=function(dict){Default.Service.SetDictionaryResult(dict)};function Initialize(){Default.Constants.PlayText=Default.Elements.get_PlayText().value;window.onresize=document.body.onresize=function(){setTimeout(Default.UI.SetTextDimensions,200);setTimeout(Default.SourceElement.UpdateOverlayDimensions,300)};Default.SourceElement.get().onpaste=function(){Default.UI.ClearHighlight();setTimeout(Default.UI.SetTextDimensions,200);setTimeout(Default.SourceElement.UpdateOverlayDimensions,300)};if(Default.Globals.PhraseAlignment)if(!Default.UI.IsMobileDevice()){$(Default.SourceElement.get()).mousemove(function(e){$(Default.SourceElement.getOverlay()).css("z-index","1");$(Default.SourceElement.getOverlay()).css("visibility","visible");var element=document.elementFromPoint(e.clientX,e.clientY),ev=jQuery.Event("mouseover");ev.clientX=e.clientX;ev.clientY=e.clientY;Default.UI.ClearHighlight();$(Default.SourceElement.getOverlay()).css("z-index","-1");$(element).trigger(ev)});$(Default.SourceElement.get()).mouseout(function(){Default.UI.ClearHighlight()})}var eTransUrlLink=document.getElementById("TransUrlLink");if(eTransUrlLink&&eTransUrlLink.innerHTML){var eUrlTransCell=document.getElementById("urlTransCell");if(eUrlTransCell)eTransUrlLink.innerHTML=eTransUrlLink.innerHTML.replace(/./g,function(m){return m+"&#8203;"})}Default.SourceElement.get().removeAttribute("disabled");Default.OutputElement.get().removeAttribute("disabled");Default.SourceElement.get().focus();if(Default.SourceValue.get()&&!Default.Globals.RTT)Default.Service.Translate(true);if(Default.Globals.RTT)setInterval(function(){Default.Service.TranslateRTT(false)},1200)}function CDefaultPrev(){return this}CDefaultPrev.prototype.Init=function(){this.eTranslationOutput=document.getElementById("DictionaryOutput");this.eMoreLink=document.getElementById("MoreLink");this.eTranslatedText=document.getElementById("TranslatedText");if(this.eTranslationOutput==null){this.eMoreLink.style.display="none";return}var h=this.eTranslationOutput.clientHeight;this.eMoreLink.style.display=parseInt(this.eTranslationOutput.scrollHeight)>h?"":"none";var eDetectLangTxt=document.getElementById("DetectLangTxt"),eDetectLangVal=document.getElementById("DetectLangVal");if(eDetectLangTxt&&eDetectLangVal){var sDetectLangTxt=eDetectLangTxt.innerText||eDetectLangTxt.textContent,sDetectLangVal=eDetectLangVal.innerText||eDetectLangVal.textContent;if(sDetectLangTxt&&sDetectLangVal)LangPairPrev.SetAutoDetectLanguage(sDetectLangTxt,sDetectLangVal)}};CDefaultPrev.prototype.SubmitToDefault=function(){var form=null;for(var i=0;i<document.forms.length;i++)if(document.forms[i].name=="MainForm"){form=document.forms[i];break}if(form==null)form=document.forms[0];form.action="default.aspx";form.target="_blank";form.method="Post";form.submit()};DefaultPrev=new CDefaultPrev;var MtPopUpList=function(){this.onChanged=null;this.shiftKeyDown=false;this.MRUL=[];this.MAX_MRUL=2};MtPopUpList.prototype={keysBuffer:"",Init:function(name,keys,values,onChanged,popupid){this.Items=[];this.Keys=[];this.KeyMap=" "+keys.join(" ")+" ";this.keysBuffer="";var x=0;for(var i=0;i<keys.length;i++){this.Items[keys[i]]=values[i];if(keys[i]!="-"){this.Keys[x]=keys[i];x++}}this.onChanged=onChanged;document.onclick=this.HideCurrentPopup;this.elemHeader=Util.GetElement("__"+name+"_header");this.elemSvID=Util.GetElement(name+"_svid");this.elemTextId=Util.GetElement(name+"_textid");this.elemPopup=document.getElementById(popupid);this.cropText();if(this.elemPopup!=null){this.elemPopup.onkeydown=(new this.doKeyDown(this,this.HideCurrentPopup)).execute;this.elemPopup.onkeyup=(new this.doKeyUp(this)).execute;this.elemPopup.onkeypress=(new this.doKeyPress(this)).execute}this.name=name;this.mrul_cookie=name+"_lpmru";var list=Util.GetCookie(this.mrul_cookie);if(list!=null&&list!="undefined")this.MRUL=list.split(",");else this.MRUL=[]},getLinks:function(){return this.elemPopup.getElementsByTagName("a")},getActiveLink:function(){var links=this.getLinks(),key=this.elemSvID.value;if(key!=null)for(var i=0;i<links.length;i++)if(links[i].href.match("#"+key+"$")!=null)return links[i];return links[0]},getByLetter:function(obj,keyCode,objLinks){var key=String.fromCharCode(keyCode).toUpperCase(),curLink=this.getActiveLink(),links=[],x;for(x=0;x<objLinks.length;x++)links[x]=objLinks[x];links.sort(function(a,b){var txtA=a.innerText||a.textContent,txtB=b.innerText||b.textContent;if(txtA<txtB)return -1;if(txtA>txtB)return 1;return 0});var i=0;for(;i<links.length;i++)if(curLink==links[i]){i++;break}for(;i<links.length;i++)if(this.getFirstChar(links[i])==key)return this.getHref(links[i]);for(x=0;x<links.length;x++)if(this.getFirstChar(links[x])==key&&curLink!=links[x])return this.getHref(links[x]);return null},getFirstChar:function(e){var x=e.innerText||e.textContent;if(x!=undefined&&x!=null&&x.length>0)return x.substr(0,1).toUpperCase();else return ""},getNextKey:function(s,offset){var idx=0;for(var i=0;i<this.Keys.length;i++)if(this.Keys[i]==s){idx=i;break}idx=idx+offset;if(idx>this.Keys.length)idx=0;else if(idx<0)idx=this.Keys.length-1;return this.Keys[idx]},getNextSibling:function(s,offset){var curLink=this.getActiveLink(),p=curLink.parentNode;while(p.tagName.toLowerCase()!="tr"&&p.parentNode!=null)p=p.parentNode;var sibs=p.getElementsByTagName("a"),idx=0;for(var i=0;i<sibs.length;i++)if(curLink.href==sibs[i].href){idx=i;break}idx=idx+offset;if(idx<0)idx=0;else if(idx>=sibs.length)idx=sibs.length-1;return this.getHref(sibs[idx])},doKeyUp:function(obj){this.execute=function(evt){if(!evt)evt=window.event;if(evt.keyCode==16){obj.shiftKeyDown=false;if(evt.preventDefault)evt.preventDefault();else evt.returnValue=false;evt.cancelBubble=true;return true}else return false}},doKeyPress:function(obj){this.execute=function(evt){if(!evt)evt=window.event;obj.keysBuffer+=String.fromCharCode(evt.charCode||evt.keyCode).toLowerCase();clearTimeout(obj.keyTimeOut);obj.keyTimeOut=setTimeout(function(){obj.keysBuffer=""},1e3)}},doKeyDown:function(obj,fnHide){this.execute=function(evt){var nextKey=null;if(!evt)evt=window.event;var links=obj.getLinks(),s=obj.elemSvID.value,isChar=false;switch(evt.keyCode){case 16:obj.shiftKeyDown=true;return false;case 9:if(obj.shiftKeyDown)nextKey=obj.getNextKey(s,-1);else nextKey=obj.getNextKey(s,1);break;case 40:nextKey=obj.getNextKey(s,1);break;case 38:nextKey=obj.getNextKey(s,-1);break;case 39:nextKey=obj.getNextSibling(s,1);break;case 37:nextKey=obj.getNextSibling(s,-1);break;case 13:case 27:fnHide();return false;default:isChar=true}if(!isChar){var nLink=links[0];for(var i=0;i<links.length;i++)if(links[i].href.indexOf("#"+nextKey)!=-1){nLink=links[i];break}try{nLink.focus();nLink.onclick()}catch(e){}return false}else{window.evt=evt;setTimeout(function(){if(!evt)evt=window.evt;var links=obj.getLinks(),nLink;for(var i=0;i<links.length;i++){var lnkText=links[i].outerText||links[i].text;if(lnkText.toLowerCase().indexOf(obj.keysBuffer)==0&&lnkText!=(obj.getActiveLink().outerText||obj.getActiveLink().text)){nLink=links[i];break}}try{if(nLink){nLink.focus();nLink.onclick()}}catch(e){}},30)}return true}},Hide:function(){this.HideCurrentPopup()},Show:function(targetObjectId,evt){if(evt){if(evt.keyCode==27){this.Hide(targetObjectId,evt);return true}if(evt.keyCode&&evt.keyCode!=40)return false;if(window.curDisplayedPopup==targetObjectId){this.HideCurrentPopup();return true}this.HideCurrentPopup();evt.cancelBubble=true;if(this.ChangeObjectDisplay(targetObjectId,"block")){window.curDisplayedDDHeader=this.elemHeader;window.curDisplayedPopup=targetObjectId;this.getActiveLink().focus();Util.addClass(this.elemHeader,"DDSActive");return true}}return false},cropText:function(){var ellipse="...",text=this.elemHeader.innerHTML;this.elemHeader.title=text;this.elemHeader.innerHTML+="____";this.elemHeader.style["overflow"]="hidden";var clientWidth=this.elemHeader.clientWidth,scrollWidth=this.elemHeader.scrollWidth,widthRatio=clientWidth*1/scrollWidth*1;if(widthRatio<1){var newLength=Math.ceil(widthRatio*text.length);if(newLength<text.length)text=String(text).substring(0,newLength-ellipse.length)+ellipse}this.elemHeader.style["overflow"]="visible";this.elemHeader.innerHTML=text},getHref:function(link){return link.href.substr(link.href.indexOf("#")+1)},setValue:function(s,suppressEvent){if(s){var sm=(new RegExp(" ("+s+") ","i")).exec(this.KeyMap);if(sm&&sm[1])s=sm[1]}if(this.Items[s]==null)throw new Error("Value is not in the current list.");this.elemSvID.value=s;this.elemHeader.value=this.Items[s];if(suppressEvent!="true")this.addMRUL(s);var p=document.getElementById(this.name);if(p.tagName=="SELECT")for(var i=0;i<p.options.length;i++){var opt=p.options[i];if(opt.value==s){opt.selected="selected";break}}this.setText(this.Items[s],suppressEvent)},getValue:function(){return this.elemSvID.value},setText:function(s,suppressEvent){var p=document.getElementById(this.name);if(p.tagName.toLowerCase()=="select")if(p.value=="")p.options[0].text=s;else if(p.options[0].value=="")p.options[0].text=this.Items[""];this.elemTextId.value=s;this.elemHeader.innerHTML=s;this.cropText();if(suppressEvent!="true")this.onChanged(s,this.Items[s])},getText:function(){return this.elemTextId.value},onclick:function(val){this.setValue(val);return false},ondragstart:function(e){if(!e)e=window.event;if(e.preventDefault)e.preventDefault()},OnSelectedValueChanged:function(){return this.onChanged},HideCurrentPopup:function(){if(window.curDisplayedPopup){Util.GetElement(window.curDisplayedPopup).style.display="none";Util.removeClass(window.curDisplayedDDHeader,"DDSActive");window.curDisplayedPopup=false;window.curDisplayedDDHeader=null}this.shiftKeyDown=false},ChangeObjectDisplay:function(objectId,newDisplay){var styleObject=Util.GetStyleObject(objectId);if(styleObject&&styleObject.display){styleObject.display=newDisplay;return true}else return false},addMRUL:function(val){if(!val)return;if(this.MRUL[0]==val)return;var dup=0,i;for(i=1;i<this.MRUL.length;i++)if(this.MRUL[i]==val){dup=i;break}if(dup==0)this.MRUL.unshift(val);else{var dupVal=dup>0?this.MRUL[dup]:val;for(i=dup;i>0;i--)this.MRUL[i]=this.MRUL[i-1];this.MRUL[0]=dupVal}while(this.MRUL.length>this.MAX_MRUL)this.MRUL.pop();Util.SetCookie(this.mrul_cookie,this.MRUL,true,Util.GetPath())}};var MtPopUpListPrev=function(){this.onChanged=null;this.shiftKeyDown=false;this.MRUL=[];this.MAX_MRUL=3;this.cur_page=0};MtPopUpListPrev.prototype={Init:function(name,keys,values,onChanged,popupid){this.Items=[];this.Keys=[];var x=0;for(var i=0;i<keys.length;i++){this.Items[keys[i]]=values[i];if(keys[i]!="-"){this.Keys[x]=keys[i];x++}}this.onChanged=onChanged;document.onclick=this.HideCurrentPopup;this.elemHeader=Util.GetElement("__"+name+"_header");this.elemSvID=Util.GetElement(name+"_svid");this.elemTextId=Util.GetElement(name+"_textid");this.elemPopup=document.getElementById(popupid);this.elemTable=Util.GetElement(name);this.cropText();this.elemPopup.onkeydown=(new this.doKeyDown(this,this.HideCurrentPopup)).execute;this.elemPopup.onkeyup=(new this.doKeyUp(this)).execute;this.name=name;this.mrul_cookie=name+"_mruls";var list=Util.GetCookie(this.mrul_cookie);if(list!=null)this.MRUL=list.split(",");this.next_btn_id=name+"_next";this.prev_btn_id=name+"_prev";this.IsRtl=document.getElementById("LangPair_SwapImg").dir=="rtl"},getLinks:function(){return this.elemTable.getElementsByTagName("a")},getActiveLink:function(fromMRUL){var links=this.getLinks(),key=this.elemSvID.value,i;if(key!=null&&key!=""){if(fromMRUL){var mkey="_"+key;for(i=0;i<links.length;i++)if(links[i].href.indexOf("#"+mkey)!=-1)return links[i];return null}for(i=0;i<links.length;i++)if(links[i].href.indexOf("#"+key)!=-1)return links[i]}return links[0]},getByLetter:function(obj,keyCode,objLinks){var key=String.fromCharCode(keyCode).toUpperCase(),curLink=this.getActiveLink(),x,links=[];for(x=0;x<objLinks.length;x++)links[x]=objLinks[x];links.sort(function(a,b){var txtA=a.innerText||a.textContent,txtB=b.innerText||b.textContent;if(txtA<txtB)return -1;if(txtA>txtB)return 1;return 0});var i=0;for(;i<links.length;i++)if(curLink==links[i]){i++;break}for(;i<links.length;i++)if(this.getFirstChar(links[i])==key)return this.getHref(links[i]);for(x=0;x<links.length;x++)if(this.getFirstChar(links[x])==key&&curLink!=links[x])return this.getHref(links[x]);return null},getFirstChar:function(e){var x=e.innerText||e.textContent;if(x!=undefined&&x!=null&&x.length>0)return x.substr(0,1).toUpperCase();else return ""},getNextKey:function(s,offset){var idx=0;for(var i=0;i<this.Keys.length;i++)if(this.Keys[i]==s){idx=i;break}idx=idx+offset;if(idx>this.Keys.length)idx=0;else if(idx<0)idx=this.Keys.length-1;return this.Keys[idx]},getNextSibling:function(s,offset){var curLink=this.getActiveLink(),p=curLink.parentNode;while(p.tagName.toLowerCase()!="tr"&&p.parentNode!=null)p=p.parentNode;var sibs=p.getElementsByTagName("a"),idx=0;for(var i=0;i<sibs.length;i++)if(curLink.href==sibs[i].href){idx=i;break}idx=idx+offset;if(idx<0)idx=0;else if(idx>=sibs.length)idx=sibs.length-1;return this.getHref(sibs[idx])},doKeyUp:function(obj){this.execute=function(evt){if(!evt)evt=window.event;if(evt.keyCode==16){obj.shiftKeyDown=false;if(evt.preventDefault)evt.preventDefault();else evt.returnValue=false;evt.cancelBubble=true;return true}else return false}},doKeyDown:function(obj,fnHide){this.execute=function(evt){if(!evt)evt=window.event;var links=obj.getLinks(),s=obj.elemSvID.value,nextKey=obj.getByLetter(obj,evt.keyCode,links);if(nextKey==null)switch(evt.keyCode){case 16:obj.shiftKeyDown=true;return false;break;case 9:if(obj.shiftKeyDown)nextKey=obj.getNextKey(s,-1);else nextKey=obj.getNextKey(s,1);break;case 40:nextKey=obj.getNextKey(s,1);break;case 38:nextKey=obj.getNextKey(s,-1);break;case 39:nextKey=obj.getNextSibling(s,1);break;case 37:nextKey=obj.getNextSibling(s,-1);break;case 13:case 27:fnHide();default:return false}var nLink=links[0];for(var i=0;i<links.length;i++)if(links[i].href.indexOf("#"+nextKey)!=-1){nLink=links[i];break}try{nLink.focus();this.clearSelectionExceptFor(nLink);nLink.onclick()}catch(e){}if(evt.preventDefault)evt.preventDefault();else evt.returnValue=false;evt.cancelBubble=true;return true}},Hide:function(targetObjectId,eventObj){this.HideCurrentPopup()},Show:function(targetObjectId,evt){if(evt){if(evt.keyCode==27){this.Hide(targetObjectId,evt);return true}if(evt.keyCode&&evt.keyCode!=40)return false;if(window.curDisplayedPopup==targetObjectId){this.HideCurrentPopup();return true}this.HideCurrentPopup();evt.cancelBubble=true;if(this.ChangeObjectDisplay(targetObjectId,"block")){window.curDisplayedPopup=targetObjectId;var link=this.getActiveLink(true);if(link){link.focus();this.clearSelectionExceptFor(link)}this.ResetPage();return true}}return false},cropText:function(){var ellipse="...",text=this.elemHeader.innerHTML;this.elemHeader.title=text;this.elemHeader.innerHTML+="____";this.elemHeader.style["overflow"]="hidden";var clientWidth=this.elemHeader.clientWidth,scrollWidth=this.elemHeader.scrollWidth,widthRatio=clientWidth*1/scrollWidth*1;if(widthRatio<1){var newLength=Math.ceil(widthRatio*text.length);if(newLength<text.length)text=String(text).substring(0,newLength-ellipse.length)+ellipse}this.elemHeader.style["overflow"]="visible";this.elemHeader.innerHTML=text},getHref:function(link){return link.href.substr(link.href.indexOf("#")+1)},setValue:function(s,suppressEvent){if(this.Items[s]==null)throw new Error("Value is not in the current list.");this.elemSvID.value=s;this.elemHeader.value=this.Items[s];if(suppressEvent!="true")this.addMRUL(s);this.setText(this.Items[s],suppressEvent)},getValue:function(){return this.elemSvID.value},setText:function(s,suppressEvent){this.elemTextId.value=s;this.elemHeader.innerHTML=s;this.cropText();if(suppressEvent!="true")this.onChanged(s,this.Items[s])},getText:function(){return this.elemTextId.value},onmouseover:function(){var langLink=event.target?event.target:event.srcElement;if(langLink.className.indexOf("selected")<0)langLink.className="hovered"},onmouseout:function(){var langLink=event.target?event.target:event.srcElement;if(langLink.className.indexOf("selected")<0)langLink.className="unhovered"},clearSelectionExceptFor:function(langLink){var links=this.getLinks();for(var i=0;i<links.length;i++)if(langLink&&langLink.href===links[i].href)links[i].className="selected";else links[i].className="unhovered"},onclick:function(val){if(this.hasAutoDetect())if(typeof val=="string"&&val=="")Util.SetCookie("autoDetectForced","True",true);else Util.SetCookie("autoDetectForced","False",true);this.clearSelectionExceptFor();this.setValue(val);return false},ondragstart:function(e){if(!e)e=window.event;if(e.preventDefault)e.preventDefault()},OnSelectedValueChanged:function(){return this.onChanged},HideCurrentPopup:function(){if(window.curDisplayedPopup){Util.GetElement(window.curDisplayedPopup).style.display="none";window.curDisplayedPopup=false}this.shiftKeyDown=false},ChangeObjectDisplay:function(objectId,newDisplay){var styleObject=Util.GetStyleObject(objectId);if(styleObject&&styleObject.display){styleObject.display=newDisplay;return true}else return false},hasAutoDetect:function(){return this.Keys[0]==""},addMRUL:function(val){if(!val)return;val=val[0]=="_"?val.substring(1):val;if(this.MRUL[0]==val)return;var dup=0,min=this.hasAutoDetect()?1:0,temp=null,i;for(i=1;i<this.MRUL.length;i++)if(this.MRUL[i]==val){dup=i;break}if(dup==0){if(!this.hasAutoDetect()&&this.MRUL.length==0)this.InsertCell("-","-",this.hasAutoDetect());this.InsertCell(val,this.Items[val],this.hasAutoDetect());this.MRUL.unshift(val)}else{var dupVal=dup>0?this.MRUL[dup]:val,rows=this.elemTable.tBodies[0].rows;for(i=dup;i>0;i--){this.MRUL[i]=this.MRUL[i-1];temp=rows[i+min].cells[0].removeChild(rows[i+min].cells[0].children[0]);rows[i+min].cells[0].appendChild(rows[i+min-1].cells[0].removeChild(rows[i+min-1].cells[0].children[0]));rows[i+min-1].cells[0].appendChild(temp)}this.MRUL[0]=dupVal}while(this.MRUL.length>this.MAX_MRUL)this.MRUL.pop();Util.SetCookie(this.mrul_cookie,this.MRUL,true)},InsertCell:function(key,value,autodetect){var rows=this.elemTable.tBodies[0].rows,newCellNode=null,i,j;if(key=="-")newCellNode=document.createElement("hr");else{newCellNode=document.createElement("a");newCellNode.tabIndex=-1;newCellNode.onclick=new Function("return "+this.name+".onclick('"+key+"');");newCellNode.onmouseover=new Function("return "+this.name+".onmouseover();");newCellNode.onmouseout=new Function("return "+this.name+".onmouseout();");newCellNode.ondragstart=new Function(this.name+".ondragstart(event);");newCellNode.href='"#_'+key+'"';newCellNode.innerText=value}var temp=null,min=autodetect?1:0;if(this.MRUL.length<this.MAX_MRUL){var completeCells=true;for(i=0;i<rows[0].cells.length;i++)if(rows[rows.length-1].cells[i].innerHTML==""){completeCells=false;break}if(completeCells)for(i=0;i<rows.length;i++)rows[i].insertCell(-1);for(i=0;i<rows[0].cells.length;i++){for(j=min;j<rows.length;j++){min=0;if(newCellNode==null){temp=null;break}if(rows[j].cells[i].children.length>0)temp=rows[j].cells[i].removeChild(rows[j].cells[i].children[0]);else temp=null;rows[j].cells[i].appendChild(newCellNode);newCellNode=temp}if(temp==null)break}}else for(j=min;j<this.MAX_MRUL+min;j++){if(rows[j].cells[0].children.length>0)temp=rows[j].cells[0].removeChild(rows[j].cells[0].children[0]);else temp=null;rows[j].cells[0].appendChild(newCellNode);newCellNode=temp}},NextPage:function(evt){this.cur_page++;return this.UpdatePage(evt)},PrevPage:function(evt){this.cur_page--;return this.UpdatePage(evt)},ResetPage:function(page){if(page&&page>0)this.cur_page=page;else this.cur_page=0;this.UpdatePage()},TotalPages:function(){return Math.round(this.elemTable.clientWidth/this.elemPopup.clientWidth)},UpdatePage:function(evt){var total=this.TotalPages();if(this.cur_page+1>=total){this.cur_page=total-1;this.ChangeObjectDisplay(this.next_btn_id,"none");this.ChangeObjectDisplay(this.prev_btn_id,"block")}else if(this.cur_page<=0){this.cur_page=0;this.ChangeObjectDisplay(this.prev_btn_id,"none");this.ChangeObjectDisplay(this.next_btn_id,"block")}else{this.ChangeObjectDisplay(this.prev_btn_id,"block");this.ChangeObjectDisplay(this.next_btn_id,"block")}var offset=this.elemPopup.clientWidth;if(this.IsRtl)this.elemTable.style.right=-(this.cur_page*offset)+"px";else this.elemTable.style.left=-(this.cur_page*offset)+"px";if(!evt)evt=window.event;if(evt.preventDefault)evt.preventDefault();else evt.returnValue=false;evt.cancelBubble=true;return true}};var FAQ=new CFAQ;function CFAQ(){return this}CFAQ.prototype.Toggle=function(strFAQ){var elemFAQq=document.getElementById(strFAQ+"q"),elemFAQs=document.getElementById(strFAQ+"s"),elemFAQa=document.getElementById(strFAQ+"a");if(elemFAQq==null||elemFAQq=="undefined")return;if(elemFAQs==null||elemFAQs=="undefined")return;if(elemFAQa==null||elemFAQa=="undefined")return;if(elemFAQa.style.display==""||elemFAQa.style.display=="none"){elemFAQs.innerHTML="-";elemFAQa.style.display="block";location.href="#"+elemFAQq.id}else{elemFAQs.innerHTML="+";elemFAQa.style.display="none"}};CFAQ.prototype.Init=function(){if(document.location.hash.length>1){var strAddress=escape(document.location.hash.substring(1)),addressLength=strAddress.length;if(addressLength>=2){if(strAddress.substring(addressLength-1,1).toLowerCase()=="q")strAddress=strAddress.substring(0,addressLength-1);this.Toggle(strAddress)}}};var LangPair=new CLangPair;function CLangPair(){return this}CLangPair.prototype.Init=function(){this.strFromLang="";this.strToLang="";this.strFromLangDesc="";this.strToLangDesc="";this.strLangPair="";this.strFromLangADL="";this.OnChangeHandlerMethod=null;if(LangPair_FromDDL_keys){LangPair_FromDDL=new MtPopUpList;LangPair_FromDDL.Init("LangPair_FromDDL",LangPair_FromDDL_keys,LangPair_FromDDL_values,LangPair_FromDDL_callback,LangPair_FromDDL_popupid)}if(LangPair_ToDDL_keys){LangPair_ToDDL=new MtPopUpList;LangPair_ToDDL.Init("LangPair_ToDDL",LangPair_ToDDL_keys,LangPair_ToDDL_values,LangPair_ToDDL_callback,LangPair_ToDDL_popupid)}this.elemSwapImg=document.getElementById("LangPair_SwapImg");this.elemFromLangLAD=document.getElementById("LangPair_FromLangLAD");this.IsRtl=this.elemSwapImg.dir=="rtl";this.ArrowDirIsReversed=false;var fromParam=Util.GetUrlParameter(window.location.href,"from");if(fromParam==null&&window.location.search&&window.location.search.toLowerCase().indexOf("from=")>-1)fromParam="";if((fromParam||fromParam=="")&&!(this.elemFromLangLAD.value&&fromParam==""))for(var i=0;i<LangPair_FromDDL_keys.length;i++)if(fromParam==LangPair_FromDDL_keys[i]){LangPair_FromDDL.setValue(fromParam,"true");break}var toParam=Util.GetUrlParameter(window.location.href,"to")||Util.GetCookie("to");if(toParam)for(var i=0;i<LangPair_ToDDL_keys.length;i++)if(toParam==LangPair_ToDDL_keys[i]){LangPair_ToDDL.setValue(toParam,"true");break}this.Sync()};CLangPair.prototype.Change=function(that){if(LangPair_FromDDL.getValue()==LangPair_ToDDL.getValue()&&this.strFromLang!=this.strToLang&&this.strFromLang!="")if(that.getValue()==this.strFromLang)LangPair_FromDDL.setValue(this.strToLang);else if(that.getValue()==this.strToLang)LangPair_ToDDL.setValue(this.strFromLang);this.Sync()};CLangPair.prototype.OnChange=function(){if(this.OnChangeHandlerMethod!=null)this.OnChangeHandlerMethod()};CLangPair.prototype.setToLang=function(strToLang){if(LangPair_ToDDL){LangPair_ToDDL.setValue(strToLang);this.Sync()}};CLangPair.prototype.setFromLang=function(strFromLang){if(LangPair_FromDDL){LangPair_FromDDL.setValue(strFromLang);this.Sync()}};CLangPair.prototype.ChangeCallbackHandler=function(method){this.OnChangeHandlerMethod=method};CLangPair.prototype.Sync=function(){if(LangPair_ToDDL!=null&&LangPair_FromDDL!=null){this.strFromLang=LangPair_FromDDL.getValue();LangPair_FromDDL.setValue(this.strFromLang,"true");this.mrulFromLangs=LangPair_FromDDL.MRUL;this.strToLang=LangPair_ToDDL.getValue();LangPair_ToDDL.setValue(this.strToLang,"true");this.mrulToLangs=LangPair_ToDDL.MRUL;this.strLangPair=this.strFromLang+"_"+this.strToLang;this.strFromLangDesc=LangPair_FromDDL.getText();this.strToLangDesc=LangPair_ToDDL.getText();this.strFromLangADL=this.elemFromLangLAD.value;this.OnChange()}};CLangPair.prototype.SetAutoDetectLanguage=function(name,value){this.strFromLangADL=this.elemFromLangLAD.value=value;LangPair_FromDDL.setText(name,"true")};CLangPair.prototype.SwapLang=function(){var from,to,lad;from=LangPair_FromDDL.getValue();to=LangPair_ToDDL.getValue();lad=this.elemFromLangLAD.value;if(from=="")from=lad;if(from!=null&&from!=""&&from!=to){LangPair_ToDDL.setValue(from);LangPair_FromDDL.setValue(to)}this.Sync()};CLangPair.prototype.SwapImg=function(horizontal){if(this.ArrowDirIsReversed)if(horizontal)this.elemSwapImg.src=window.staticContentFolder+"/img/swapLTR.gif";else if(this.IsRtl)this.elemSwapImg.src=window.staticContentFolder+"/img/swapToVertRTL.gif";else this.elemSwapImg.src=window.staticContentFolder+"/img/swapToVertLTR.gif";else if(horizontal)this.elemSwapImg.src=window.staticContentFolder+"/img/swapRTL.gif";else if(this.IsRtl)this.elemSwapImg.src=window.staticContentFolder+"/img/swapFromVertRTL.gif";else this.elemSwapImg.src=window.staticContentFolder+"/img/swapFromVertLTR.gif";this.ArrowDirIsReversed=!this.ArrowDirIsReversed};var LangPairPrev=new CLangPairPrev;function CLangPairPrev(){return this}CLangPairPrev.prototype.Init=function(){this.strFromLang="";this.strToLang="";this.strFromLangDesc="";this.strToLangDesc="";this.strLangPair="";this.strFromLangADL="";this.OnChangeHandlerMethod=null;if(LangPair_FromDDL_keys){LangPair_FromDDL=new MtPopUpListPrev;LangPair_FromDDL.Init("LangPair_FromDDL",LangPair_FromDDL_keys,LangPair_FromDDL_values,LangPair_FromDDL_callback,LangPair_FromDDL_popupid)}if(LangPair_ToDDL_keys){LangPair_ToDDL=new MtPopUpListPrev;LangPair_ToDDL.Init("LangPair_ToDDL",LangPair_ToDDL_keys,LangPair_ToDDL_values,LangPair_ToDDL_callback,LangPair_ToDDL_popupid)}this.elemSwapImg=document.getElementById("LangPair_SwapImg");this.elemFromLangLAD=document.getElementById("LangPair_FromLangLAD");this.IsRtl=this.elemSwapImg.dir=="rtl";this.ArrowDirIsReversed=false;this.Sync()};CLangPairPrev.prototype.Change=function(that){if(LangPair_FromDDL.getValue()==LangPair_ToDDL.getValue()&&this.strFromLang!=this.strToLang&&this.strFromLang!="")if(that.getValue()==this.strFromLang)LangPair_FromDDL.setValue(this.strToLang);else if(that.getValue()==this.strToLang)LangPair_ToDDL.setValue(this.strFromLang);this.Sync()};CLangPairPrev.prototype.OnChange=function(){if(this.OnChangeHandlerMethod!=null)this.OnChangeHandlerMethod()};CLangPairPrev.prototype.ChangeCallbackHandler=function(method){this.OnChangeHandlerMethod=method};CLangPairPrev.prototype.Sync=function(){if(LangPair_ToDDL!=null&&LangPair_FromDDL!=null){this.strFromLang=LangPair_FromDDL.getValue();LangPair_FromDDL.setValue(this.strFromLang,"true");this.strToLang=LangPair_ToDDL.getValue();LangPair_ToDDL.setValue(this.strToLang,"true");this.strLangPair=this.strFromLang+"_"+this.strToLang;this.strFromLangDesc=LangPair_FromDDL.getText();this.strToLangDesc=LangPair_ToDDL.getText();this.strFromLangADL=this.elemFromLangLAD.value;this.OnChange()}};CLangPairPrev.prototype.SetAutoDetectLanguage=function(name,value){this.strFromLangADL=this.elemFromLangLAD.value=value;LangPair_FromDDL.setText(name,"true")};CLangPairPrev.prototype.SwapLang=function(){var from,to,lad;from=LangPair_FromDDL.getValue();to=LangPair_ToDDL.getValue();lad=this.elemFromLangLAD.value;if(from=="")from=lad;if(from!=null&&from!=""&&from!=to){LangPair_ToDDL.setValue(from);LangPair_FromDDL.setValue(to)}this.Sync()};CLangPairPrev.prototype.SwapImg=function(horizontal){if(this.ArrowDirIsReversed)if(horizontal)this.elemSwapImg.src=window.staticContentFolder+"/img/swapLTR.gif";else if(this.IsRtl)this.elemSwapImg.src=window.staticContentFolder+"/img/swapToVertRTL.gif";else this.elemSwapImg.src=window.staticContentFolder+"/img/swapToVertLTR.gif";else if(horizontal)this.elemSwapImg.src=window.staticContentFolder+"/img/swapRTL.gif";else if(this.IsRtl)this.elemSwapImg.src=window.staticContentFolder+"/img/swapFromVertRTL.gif";else this.elemSwapImg.src=window.staticContentFolder+"/img/swapFromVertLTR.gif";this.ArrowDirIsReversed=!this.ArrowDirIsReversed};Layout=new CLayout;Layout.Properties={AReport:null,GoLink:null,LblReported:null,UrlInput:null,TgtParent:null,SrcParent:null,TgtFrame:null,SrcFrame:null,DivSrc:null,DivTgt:null,Content:null,SrcMouse:null,TgtMouse:null,Header:null,Footer_BV:null,Footer_Brand:null,Footer_SB:null,Footer_Live:null,Views:["SS","TB","TP","SP"],ViewTypes:{SideBySide:null,TopBottom:null,TargetOnly:null,SourceOnly:null},ActiveView:"",AnimationBlock:null,AnimationDynamic:null,AnimationStatic:null,AnimationRunning:false,GetDefaultView:function(){return this.Views[2]},GetUrlValue:function(){if(this.UrlInput!=null)return this.UrlInput.value;else return ""}};Layout.Methods={Init:function(url,view){with(Layout.Properties){GoLink=document.getElementById("aExit");AReport=document.getElementById("aReport");LblReported=document.getElementById("lblReported");UrlInput=document.getElementById("inpUrl");Content=document.getElementById("divContent");TgtParent=document.getElementById("divTgtFrm");SrcParent=document.getElementById("divSrcFrm");DivSrc=document.getElementById("divSrc");DivTgt=document.getElementById("divTgt");SrcMouse=document.getElementById("lblSrcMouse");TgtMouse=document.getElementById("lblTgtMouse");Header=document.getElementById("divBVHeader");Footer_BV=document.getElementById("divBVFooter");Footer_Brand=document.getElementById("uxp_ftr_control");Footer_SB=document.getElementById("sb_foot");Footer_Live=document.getElementById("WindowsLiveFooter");AnimationBlock=document.getElementById("spnAnim");AnimationDynamic=document.getElementById("spnTgtLangDynamic");AnimationStatic=document.getElementById("spnTgtLangStatic");AnimationRunning=false;ViewTypes.SideBySide=Views[0];ViewTypes.TopBottom=Views[1];ViewTypes.TargetOnly=Views[2];ViewTypes.SourceOnly=Views[3];if(!Footer_Brand)Footer_Brand=Footer_SB!=null?Footer_SB:Footer_Live;GoLink.className="";if(url&&url.length>0){GoLink.href=UrlInput.value=url;UrlInput.onchange();if(AReport)AReport.href="javascript:BV.ReportPage();"}else GoLink.className="Invisible";UrlInput.focus()}this.SetView(view)},SetView:function(view){with(Layout.Properties){var isvalid=false;if(view!=null){ActiveView=view.toUpperCase();for(var i in Views)if(Views[i]==ActiveView){isvalid=true;break}}if(!isvalid)ActiveView=GetDefaultView();switch(ActiveView){case ViewTypes.SideBySide:DivSrc.className="divSrcSS";DivTgt.className="divTgtSS";SrcMouse.className=TgtMouse.className="Invisible";this.SetSideBySideWidths();if(BV.setTooltips)BV.setTooltips(false);break;case ViewTypes.TopBottom:DivSrc.className="divSrcTB";DivTgt.className="divTgtTB";SrcMouse.className=TgtMouse.className="Invisible";if(BV.setTooltips)BV.setTooltips(false);break;case ViewTypes.SourceOnly:DivSrc.className="divXP";DivTgt.className="Invisible";SrcMouse.className="";TgtMouse.className="Invisible";if(BV.setTooltips)BV.setTooltips(true);break;default:DivSrc.className="Invisible";DivTgt.className="divXP";SrcMouse.className="Invisible";TgtMouse.className="";if(BV.setTooltips)BV.setTooltips(true);break}}Layout.Sync()},SetHeight:function(h){with(Layout.Properties){var isTB=ActiveView==ViewTypes.TopBottom,h1=isTB?h/2-4:h-4,h2=h1%2!=0?isTB?h1-1:h1:h1;Content.style.height=h+"px";TgtParent.style.height=h1+"px";SrcParent.style.height=h2+"px";if(SrcFrame!=null)SrcFrame.style.height=h1-1+"px";if(TgtFrame!=null)TgtFrame.style.height=h2-1+"px"}},SetSourceTarget:function(src,tgt){Layout.Properties.SrcFrame=src;Layout.Properties.TgtFrame=tgt;Layout.Sync()},BeginAnimation:function(){this.SetAnimationState(false,true);this.RunAnimation()},EndAnimation:function(hide){this.SetAnimationState(true,false,hide)},ShowAnimationPercent:function(n){this.SetAnimationState(false,false);Layout.Properties.AnimationBlock.innerHTML="&nbsp;"+(n>100?99:n)+"%"},AnimTimeout:null,RunAnimation:function(){if(Layout.Properties.AnimationRunning)with(Layout.Properties){AnimationBlock.innerHTML+=".";if(AnimationBlock.innerHTML.length>6)AnimationBlock.innerHTML=""}this.AnimTimeout=setTimeout(Layout.Methods.RunAnimation,500)},SetAnimationState:function(isStatic,run,hide){with(Layout.Properties){AnimationRunning=run;if(!run&&this.AnimTimeout!=null)clearTimeout(this.AnimTimeout);if(hide){AnimationDynamic.className="Invisible";AnimationStatic.className="Invisible"}else if(isStatic){AnimationDynamic.className="Invisible";AnimationStatic.className="Visible"}else{AnimationStatic.className="Invisible";AnimationDynamic.className="Visible"}}},SetSideBySideWidths:function(){if(Layout.Properties.SrcFrame==null||Layout.Properties.TgtFrame==null)return;if(Layout.Properties.ActiveView!=Layout.Properties.ViewTypes.SideBySide)return;var cw=Layout.Properties.Content.clientWidth;if(cw%2!=0)cw--;Layout.Properties.Content.width=cw;Layout.Properties.SrcFrame.width=cw/2;Layout.Properties.TgtFrame.width=cw/2},HideBVReport:function(){Layout.Properties.AReport.style.display="none"},ShowBVThanksReporting:function(){Layout.Properties.LblReported.style.display="inline"}};function CLayout(){return this}CLayout.prototype.Init=function(){Layout.Methods.Init(Util.GetDocumentUrl(document),Util.GetUrlParameter(location.href,"lo")||Util.GetCookie("lo"));Layout.Methods.SetView(Layout.Properties.ActiveView);this.Sync()};CLayout.prototype.Sync=function(){var sbFooterHeight=0,minHeight=150;with(Layout.Properties){if(Footer_SB!=null)sbFooterHeight=Footer_SB.offsetHeight;var iHeaderFooterHeight=+Header.offsetHeight+Footer_BV.offsetHeight+sbFooterHeight+10;if(document.documentElement.clientHeight<=iHeaderFooterHeight)return;var iHeight=document.documentElement.clientHeight-iHeaderFooterHeight;if(iHeight<minHeight)iHeight=minHeight;for(var i=0;i<Views.length;i++)document.getElementById(Views[i]).className=Views[i]+"_gif";document.getElementById(ActiveView).className=ActiveView+"on_gif"}Layout.Methods.SetHeight(iHeight);Layout.Methods.SetSideBySideWidths()};PlayerState={NoPlayer:0,Stopped:1,Paused:2,Playing:3,Ended:4,Error:5,Unknown:6};WmpState={MpStopped:1,MpPaused:2,MpPlaying:3,MpEnded:8};MediaType={NA:0,WMP:1,QT:2};var PlayTimerId=null;function IsStopped(){var time=document.getElementById(Media.ID).GetTime(),rate=document.getElementById(Media.ID).GetRate(),duration=document.getElementById(Media.ID).GetDuration(),status=document.getElementById(Media.ID).GetPluginStatus().toLowerCase;window.status=time;if(status=="error"){if(Media.OnError!=null)Media.OnError();return}if(rate==0)if(time==duration){if(Media.OnStop!=null)Media.OnStop();return}else{if(Media.OnPaused!=null)Media.OnPaused();return}else StartWatchTimer(500)}function StartWatchTimer(timeDelay){if(PlayTimerId!=null)clearTimeout(PlayTimerId);PlayTimerId=window.setTimeout("IsStopped()",timeDelay)}MediaPlayer=function(){this.PlayerObject=null;this.OnStopEvent=null;this.OnPlayEvent=null;this.OnPauseEvent=null;this.OnErrorEvent=null;this.Pause=null;this.DoPlay=null;this.Stop=null;this.Height=100;this.Width=100;this.AutoPlay=true;this.Create=null;this.HandleEvents=null;this.Play=function(){};this.Stop=function(){};this.Pause=function(){}};Media={PreferredType:null,PlayerType:null,SupportsQT:false,SupportsWMP:false,Enabled:false,URL:"",HtmlParent:null,ID:"mediaplayer",Initalized:false,OnPlay:null,OnStop:null,OnPaused:null,OnError:null,Player:null,PlayerCreated:false,Play:function(url){var urlIsNew=Media.URL!=url;Media.URL=url;if(!Media.Player)if(Media.PlayerType==MediaType.WMP)Media.MakeWMPPlayer();else Media.MakeQTPlayer();if(Media.PlayerType==MediaType.WMP){if(!Media.PlayerCreated){Media.Player.Create();Media.PlayerCreated=true}if(urlIsNew)Media.Player.SetUrl(url);Media.Player.DoPlay()}else Media.Player.SetUrl(url)},Pause:function(){Media.Player.Pause()},Stop:function(){if(Media.Player)Media.Player.Stop()},MakeWMPPlayer:function(){document.mediaPlayerType=MediaType.WMP;Media.Player=new MediaPlayer;with(Media){Player.Create=function(url,parent){Player.PlayerObject=document.createElement("object");Player.PlayerObject.id=Media.ID;Player.PlayerObject.classid="clsid:6BF52A52-394A-11d3-B153-00C04F79FAA6";Player.PlayerObject.autoStart=true;Player.PlayerObject.width=1;Player.PlayerObject.height=1;if(Player.PlayerObject.uiMode)Player.PlayerObject.uiMode="none";Player.PlayerObject.URL=url;HtmlParent.appendChild(Player.PlayerObject);Player.PlayerObject.attachEvent("playStateChange",function(playState){if(playState==WmpState.MpStopped)if(Media.OnStop!=null)Media.OnStop()})};Player.SetUrl=function(url){this.PlayerObject.URL=url};Player.DoPlay=function(){this.PlayerObject.controls.Play();if(Media.OnPlay!=null)Media.OnPlay()};Player.Stop=function(){if(this.PlayerObject){this.PlayerObject.controls.Stop();if(Media.OnStop!=null)Media.OnStop()}};Player.Pause=function(){this.PlayerObject.controls.Pause();if(Media.OnPaused!=null)Media.OnPaused()}}},MakeQTPlayer:function(){document.mediaPlayerType=MediaType.QT;Media.Player=new MediaPlayer;with(Media){Player.Create=function(url,parent){};Player.SetUrl=function(url){var oldChild=document.getElementById(Media.ID),newChild=document.createElement("embed");newChild.setAttribute("PLUGINSPAGE","http://www.apple.com/quicktime/download/");newChild.setAttribute("EnableJavaScript","true");newChild.setAttribute("CONTROLLER","True");newChild.setAttribute("autostart","true");newChild.setAttribute("width","100");newChild.setAttribute("height","100");newChild.setAttribute("id",Media.ID);newChild.setAttribute("hidden","false");newChild.setAttribute("style","position:absolute;z-index:99;top:-300;left:-300;visibility:hidden;");newChild.setAttribute("src",Media.URL);if(oldChild!=null)Media.HtmlParent.replaceChild(newChild,oldChild);else Media.HtmlParent.appendChild(newChild)};Player.DoPlay=function(){};Player.Stop=function(){};Player.Pause=function(){}}},GetPlayerType:function(){if(Media.SupportsQT==false&&Media.SupportsWMP==false)return MediaType.NA;if(Media.PreferredType==MediaType.WMP&&Media.SupportsWMP)return MediaType.WMP;else if(Media.PreferredType==MediaType.QT&&Media.SupportsQT)return MediaType.QT;else if(Media.SupportsWMP)return MediaType.WMP;else return MediaType.QT},Init:function(){if(Media.Initalized)return;Media.Enabled=true;Media.SupportsWMP=MediaUtils.supportsWMP();Media.SupportsQT=MediaUtils.supportsQT();Media.Enabled=Media.SupportsWMP||Media.SupportsQT;Media.PlayerType=Media.GetPlayerType();Media.Initalized=true}};MediaUtils={Initialized:false,dvb:false,canDetect:function(){this.dvb=this.initVB();if(this.dvb||navigator.plugins&&navigator.plugins.length>0)return true;else return false},supportsWMP:function(){if(this.canDetect()){var b=this.detect("Windows Media");if(!b&&this.dvb)b=detectAX("wmplayer.ocx");return b}else return false},supportsQT:function(){if(this.canDetect()){var b=this.detect("QuickTime");if(!b&&this.dvb)b=detectQtAx();return b}else return false},detect:function(){var daPlugins=arguments,foundit=false;if(navigator.plugins&&navigator.plugins.length>0){var pluginsArrayLength=navigator.plugins.length;for(pluginsArrayCounter=0;pluginsArrayCounter<pluginsArrayLength;pluginsArrayCounter++){var numFound=0;for(namesCounter=0;namesCounter<daPlugins.length;namesCounter++)if(navigator.plugins[pluginsArrayCounter].name.indexOf(daPlugins[namesCounter])>=0||navigator.plugins[pluginsArrayCounter].description.indexOf(daPlugins[namesCounter])>=0)numFound++;if(numFound==daPlugins.length){foundit=true;break}}}return foundit},initVB:function(){if(navigator.userAgent.indexOf("MSIE")!=-1&&navigator.userAgent.indexOf("Win")!=-1){if(this.Initialized==false){this.Initialized=true;document.writeln('<script language="VBscript">');document.writeln("dvb = False");document.writeln("If ScriptEngineMajorVersion >= 2 then");document.writeln("  dvb = True");document.writeln("End If");document.writeln("Function detectAX(axName)");document.writeln("  on error resume next");document.writeln("  detectAX = False");document.writeln("  If dvb Then");document.writeln("     detectAX = IsObject(CreateObject(axName))");document.writeln("  End If");document.writeln("End Function");document.writeln("Function detectQtAx()");document.writeln("  on error resume next");document.writeln("  detectQtAx = False");document.writeln("  If dvb Then");document.writeln("    detectQtAx = False");document.writeln("    hasQTChkr = false");document.writeln('    Set hasQTChkr = CreateObject("QuickTime.QuickTime")');document.writeln("    If IsObject(hasQTChkr) Then");document.writeln("      If hasQTChkr.IsQuickTimeAvailable(0) Then ");document.writeln("        detectQtAx = True");document.writeln("      End If");document.writeln("    End If");document.writeln("  End If");document.writeln("End Function");document.writeln("</script>")}return true}return false}};var s_account="mswlsrccrmmsfttranslator",s=s_gi(s_account);s.charSet="ISO-8859-1";s.currencyCode="USD";s.trackDownloadLinks=true;s.trackExternalLinks=true;s.trackInlineStats=true;s.linkDownloadFileTypes="exe,zip,wav,mp3,mov,mpg,avi,wmv,pdf,doc,docx,xls,xlsx,ppt,pptx,msi";s.linkInternalFilters="javascript:,bing.com";s.linkLeaveQueryString=false;s.linkTrackVars="events,evar1,prop1";s.linkTrackEvents="event1";s.usePlugins=true;function s_doPlugins(s){s.prop3=s.getVisitNum();s.eVar3=s.prop3;s.prop4=s.getNewRepeat();s.eVar4=s.prop4;s.eVar5=s.getQueryParam("form");s.eVar5=s.getValOnce(s.eVar5,"s_eVar5",0);s.prop5=s.eVar5;s.eVar6=s.getQueryParam("publ");s.eVar6=s.getValOnce(s.eVar6,"s_eVar6",0);s.prop6=s.eVar6;s.eVar7=s.getQueryParam("crea");s.eVar7=s.getValOnce(s.eVar7,"s_eVar7",0);s.prop7=s.eVar7}s.doPlugins=s_doPlugins;s.getQueryParam=new Function("p","d","u","var s=this,v='',i,t;d=d?d:'';u=u?u:(s.pageURL?s.pageURL:s.wd.location);if(u=='f')u=s.gtfs().location;while(p){i=p.indexOf(',');i=i<0?p.length:i;t=s.p_gpv(p.substring(0,i),u+'');if(t){t=t.indexOf('#')>-1?t.substring(0,t.indexOf('#')):t;}if(t)v+=v?d+t:t;p=p.substring(i==p.length?i:i+1)}return v");s.p_gpv=new Function("k","u","var s=this,v='',i=u.indexOf('?'),q;if(k&&i>-1){q=u.substring(i+1);v=s.pt(q,'&','p_gvf',k)}return v");s.p_gvf=new Function("t","k","if(t){var s=this,i=t.indexOf('='),p=i<0?t:t.substring(0,i),v=i<0?'True':t.substring(i+1);if(p.toLowerCase()==k.toLowerCase())return s.epa(v)}return ''");s.getValOnce=new Function("v","c","e","var s=this,k=s.c_r(c),a=new Date;e=e?e:0;if(v){a.setTime(a.getTime()+e*86400000);s.c_w(c,v,e?a:0);}return v==k?'':v");s.getVisitNum=new Function("var s=this,e=new Date(),cval,cvisit,ct=e.getTime(),c='s_vnum',c2='s_invisit';e.setTime(ct+30*24*60*60*1000);cval=s.c_r(c);if(cval){var i=cval.indexOf('&vn='),str=cval.substring(i+4,cval.length),k;}cvisit=s.c_r(c2);if(cvisit){if(str){e.setTime(ct+30*60*1000);s.c_w(c2,'true',e);return str;}else return 'unknown visit number';}else{if(str){str++;k=cval.substring(0,i);e.setTime(k);s.c_w(c,k+'&vn='+str,e);e.setTime(ct+30*60*1000);s.c_w(c2,'true',e);return str;}else{s.c_w(c,ct+30*24*60*60*1000+'&vn=1',e);e.setTime(ct+30*60*1000);s.c_w(c2,'true',e);return 1;}}");s.getNewRepeat=new Function("vars=this,e= new Date(),ct=e.getTime(),y=e.getYear();e.setTime(ct+9999*24*60*60*1000);cval=s.c_r('s_nr');if(cval.length==0){s.c_w('s_nr',ct,e);return 'New';}if(cval.length!=0&&ct-cval<30*60*1000){s.c_w('s_nr',ct,e);return 'New';}if(cval<1123916400001){e.setTime(cval+30*24*60*60*1000);s.c_w('s_nr',ct,e);return 'Repeat';}else return 'Repeat';");s.vpr=new Function("vs","v","var s=this,k=vs.substring(0,2)=='s_'?vs.substring(2):vs;s['vpv_'+k]=v;s['vpm_'+k]=1");s.dt=new Function("tz","t","var d=new Date;if(t)d.setTime(t);d=new Date(d.getTime()+(d.getTimezoneOffset()*60*1000));return new Date(Math.floor(d.getTime()+(tz*60*60*1000)))");s.vh_gt=new Function("k","v","var s=this,vh='|'+s.c_r('s_vh_'+k),vi=vh.indexOf('|'+v+'='),ti=vi<0?vi:vi+2+v.length,pi=vh.indexOf('|',ti),t=ti<0?'':vh.substring(ti,pi<0?vh.length:pi);return t");s.vh_gl=new Function("k","var s=this,vh=s.c_r('s_vh_'+k),e=vh?vh.indexOf('='):0;return vh?(vh.substring(0,e?e:vh.length)):''");s.vh_s=new Function("k","v","if(k&&v){var s=this,e=new Date,st=e.getTime(),y=e.getYear(),c='s_vh_'+k,vh='|'+s.c_r(c)+'|',t=s.vh_gt(k,v);e.setYear((y<1900?y+1900:y)+5);if(t)vh=s.rep(vh,'|'+v+'='+t+'|','|');if(vh.substring(0,1)=='|')vh=vh.substring(1);if(vh.substring(vh.length-1,vh.length)=='|')vh=vh.substring(0,vh.length-1);vh=v+'=[PCC]'+(vh?'|'+vh:'');s.c_w(c,vh,e);if(s.vh_gt(k,v)!='[PCC]')return 0;vh=s.rep(vh,'[PCC]',st);s.c_w(c,vh,e)}return 1");s.p_fo=new Function("n","var s=this;if(!s.__fo){s.__fo=new Object;}if(!s.__fo[n]){s.__fo[n]=new Object;return 1;}else {return 0;}");s.visitorNamespace="microsoftwlsearchcrm";s.trackingServer="microsoftwlsearchcrm.112.2o7.net";var s_code="",s_objectID;function s_gi(un,pg,ss){var c="s.version='H.24.3';s.an=s_an;s.logDebug=function(m){var s=this,tcf=new Function('var e;try{console.log(\"'+s.rep(s.rep(m,\"\\n\",\"\\\\n\"),\"\\\"\",\"\\\\\\\"\")+'\");}catch(e){}');tcf()};s.cls=function(x,c){var i,y='';if(!c)c=this.an;for(i=0;i<x.length;i++){n=x.substring(i,i+1);if(c.indexOf(n)>=0)y+=n}return y};s.fl=function(x,l){return x?(''+x).substring(0,l):x};s.co=function(o){if(!o)return o;var n=new Object,x;for(x in o)if(x.indexOf('select')<0&&x.indexOf('filter')<0)n[x]=o[x];return n};s.num=function(x){x=''+x;for(var p=0;p<x.length;p++)if(('0123456789').indexOf(x.substring(p,p+1))<0)return 0;return 1};s.rep=s_rep;s.sp=s_sp;s.jn=s_jn;s.ape=function(x){var s=this,h='0123456789ABCDEF',i,c=s.charSet,n,l,e,y='';c=c?c.toUpperCase():'';if(x){x=''+x;if(s.em==3)x=encodeURIComponent(x);else if(c=='AUTO'&&('').charCodeAt){for(i=0;i<x.length;i++){c=x.substring(i,i+1);n=x.charCodeAt(i);if(n>127){l=0;e='';while(n||l<4){e=h.substring(n%16,n%16+1)+e;n=(n-n%16)/16;l++}y+='%u'+e}else if(c=='+')y+='%2B';else y+=escape(c)}x=y}else x=escape(''+x);x=s.rep(x,'+','%2B');if(c&&c!='AUTO'&&s.em==1&&x.indexOf('%u')<0&&x.indexOf('%U')<0){i=x.indexOf('%');while(i>=0){i++;if(h.substring(8).indexOf(x.substring(i,i+1).toUpperCase())>=0)return x.substring(0,i)+'u00'+x.substring(i);i=x.indexOf('%',i)}}}return x};s.epa=function(x){var s=this;if(x){x=s.rep(''+x,'+',' ');return s.em==3?decodeURIComponent(x):unescape(x)}return x};s.pt=function(x,d,f,a){var s=this,t=x,z=0,y,r;while(t){y=t.indexOf(d);y=y<0?t.length:y;t=t.substring(0,y);r=s[f](t,a);if(r)return r;z+=y+d.length;t=x.substring(z,x.length);t=z<x.length?t:''}return ''};s.isf=function(t,a){var c=a.indexOf(':');if(c>=0)a=a.substring(0,c);c=a.indexOf('=');if(c>=0)a=a.substring(0,c);if(t.substring(0,2)=='s_')t=t.substring(2);return (t!=''&&t==a)};s.fsf=function(t,a){var s=this;if(s.pt(a,',','isf',t))s.fsg+=(s.fsg!=''?',':'')+t;return 0};s.fs=function(x,f){var s=this;s.fsg='';s.pt(x,',','fsf',f);return s.fsg};s.si=function(){var s=this,i,k,v,c=s_gi+'var s=s_gi(\"'+s.oun+'\");s.sa(\"'+s.un+'\");';for(i=0;i<s.va_g.length;i++){k=s.va_g[i];v=s[k];if(v!=undefined){if(typeof(v)!='number')c+='s.'+k+'=\"'+s_fe(v)+'\";';else c+='s.'+k+'='+v+';'}}c+=\"s.lnk=s.eo=s.linkName=s.linkType=s.wd.s_objectID=s.ppu=s.pe=s.pev1=s.pev2=s.pev3='';\";return c};s.c_d='';s.c_gdf=function(t,a){var s=this;if(!s.num(t))return 1;return 0};s.c_gd=function(){var s=this,d=s.wd.location.hostname,n=s.fpCookieDomainPeriods,p;if(!n)n=s.cookieDomainPeriods;if(d&&!s.c_d){n=n?parseInt(n):2;n=n>2?n:2;p=d.lastIndexOf('.');if(p>=0){while(p>=0&&n>1){p=d.lastIndexOf('.',p-1);n--}s.c_d=p>0&&s.pt(d,'.','c_gdf',0)?d.substring(p):d}}return s.c_d};s.c_r=function(k){var s=this;k=s.ape(k);var c=' '+s.d.cookie,i=c.indexOf(' '+k+'='),e=i<0?i:c.indexOf(';',i),v=i<0?'':s.epa(c.substring(i+2+k.length,e<0?c.length:e));return v!='[[B]]'?v:''};s.c_w=function(k,v,e){var s=this,d=s.c_gd(),l=s.cookieLifetime,t;v=''+v;l=l?(''+l).toUpperCase():'';if(e&&l!='SESSION'&&l!='NONE'){t=(v!=''?parseInt(l?l:0):-60);if(t){e=new Date;e.setTime(e.getTime()+(t*1000))}}if(k&&l!='NONE'){s.d.cookie=k+'='+s.ape(v!=''?v:'[[B]]')+'; path=/;'+(e&&l!='SESSION'?' expires='+e.toGMTString()+';':'')+(d?' domain='+d+';':'');return s.c_r(k)==v}return 0};s.eh=function(o,e,r,f){var s=this,b='s_'+e+'_'+s._in,n=-1,l,i,x;if(!s.ehl)s.ehl=new Array;l=s.ehl;for(i=0;i<l.length&&n<0;i++){if(l[i].o==o&&l[i].e==e)n=i}if(n<0){n=i;l[n]=new Object}x=l[n];x.o=o;x.e=e;f=r?x.b:f;if(r||f){x.b=r?0:o[e];x.o[e]=f}if(x.b){x.o[b]=x.b;return b}return 0};s.cet=function(f,a,t,o,b){var s=this,r,tcf;if(s.apv>=5&&(!s.isopera||s.apv>=7)){tcf=new Function('s','f','a','t','var e,r;try{r=s[f](a)}catch(e){r=s[t](e)}return r');r=tcf(s,f,a,t)}else{if(s.ismac&&s.u.indexOf('MSIE 4')>=0)r=s[b](a);else{s.eh(s.wd,'onerror',0,o);r=s[f](a);s.eh(s.wd,'onerror',1)}}return r};s.gtfset=function(e){var s=this;return s.tfs};s.gtfsoe=new Function('e','var s=s_c_il['+s._in+'],c;s.eh(window,\"onerror\",1);s.etfs=1;c=s.t();if(c)s.d.write(c);s.etfs=0;return true');s.gtfsfb=function(a){return window};s.gtfsf=function(w){var s=this,p=w.parent,l=w.location;s.tfs=w;if(p&&p.location!=l&&p.location.host==l.host){s.tfs=p;return s.gtfsf(s.tfs)}return s.tfs};s.gtfs=function(){var s=this;if(!s.tfs){s.tfs=s.wd;if(!s.etfs)s.tfs=s.cet('gtfsf',s.tfs,'gtfset',s.gtfsoe,'gtfsfb')}return s.tfs};s.mrq=function(u){var s=this,l=s.rl[u],n,r;s.rl[u]=0;if(l)for(n=0;n<l.length;n++){r=l[n];s.mr(0,0,r.r,r.t,r.u)}};s.flushBufferedRequests=function(){};s.mr=function(sess,q,rs,ta,u){var s=this,dc=s.dc,t1=s.trackingServer,t2=s.trackingServerSecure,tb=s.trackingServerBase,p='.sc',ns=s.visitorNamespace,un=s.cls(u?u:(ns?ns:s.fun)),r=new Object,l,imn='s_i_'+(un),im,b,e;if(!rs){if(t1){if(t2&&s.ssl)t1=t2}else{if(!tb)tb='2o7.net';if(dc)dc=(''+dc).toLowerCase();else dc='d1';if(tb=='2o7.net'){if(dc=='d1')dc='112';else if(dc=='d2')dc='122';p=''}t1=un+'.'+dc+'.'+p+tb}rs='http'+(s.ssl?'s':'')+'://'+t1+'/b/ss/'+s.un+'/'+(s.mobile?'5.1':'1')+'/'+s.version+(s.tcn?'T':'')+'/'+sess+'?AQB=1&ndh=1'+(q?q:'')+'&AQE=1';if(s.isie&&!s.ismac)rs=s.fl(rs,2047)}if(s.d.images&&s.apv>=3&&(!s.isopera||s.apv>=7)&&(s.ns6<0||s.apv>=6.1)){if(!s.rc)s.rc=new Object;if(!s.rc[un]){s.rc[un]=1;if(!s.rl)s.rl=new Object;s.rl[un]=new Array;setTimeout('if(window.s_c_il)window.s_c_il['+s._in+'].mrq(\"'+un+'\")',750)}else{l=s.rl[un];if(l){r.t=ta;r.u=un;r.r=rs;l[l.length]=r;return ''}imn+='_'+s.rc[un];s.rc[un]++}im=s.wd[imn];if(!im)im=s.wd[imn]=new Image;im.s_l=0;im.onload=new Function('e','this.s_l=1;var wd=window,s;if(wd.s_c_il){s=wd.s_c_il['+s._in+'];s.mrq(\"'+un+'\");s.nrs--;if(!s.nrs)s.m_m(\"rr\")}');if(!s.nrs){s.nrs=1;s.m_m('rs')}else s.nrs++;if(s.debugTracking){var d='AppMeasurement Debug: '+rs,dl=s.sp(rs,'&'),dln;for(dln=0;dln<dl.length;dln++)d+=\"\\n\\t\"+s.epa(dl[dln]);s.logDebug(d)}im.src=rs;if((!ta||ta=='_self'||ta=='_top'||(s.wd.name&&ta==s.wd.name))&&rs.indexOf('&pe=')>=0){b=e=new Date;while(!im.s_l&&e.getTime()-b.getTime()<500)e=new Date}return ''}return '<im'+'g sr'+'c=\"'+rs+'\" width=1 height=1 border=0 alt=\"\">'};s.gg=function(v){var s=this;if(!s.wd['s_'+v])s.wd['s_'+v]='';return s.wd['s_'+v]};s.glf=function(t,a){if(t.substring(0,2)=='s_')t=t.substring(2);var s=this,v=s.gg(t);if(v)s[t]=v};s.gl=function(v){var s=this;if(s.pg)s.pt(v,',','glf',0)};s.rf=function(x){var s=this,y,i,j,h,p,l=0,q,a,b='',c='',t;if(x&&x.length>255){y=''+x;i=y.indexOf('?');if(i>0){q=y.substring(i+1);y=y.substring(0,i);h=y.toLowerCase();j=0;if(h.substring(0,7)=='http://')j+=7;else if(h.substring(0,8)=='https://')j+=8;i=h.indexOf(\"/\",j);if(i>0){h=h.substring(j,i);p=y.substring(i);y=y.substring(0,i);if(h.indexOf('google')>=0)l=',q,ie,start,search_key,word,kw,cd,';else if(h.indexOf('yahoo.co')>=0)l=',p,ei,';if(l&&q){a=s.sp(q,'&');if(a&&a.length>1){for(j=0;j<a.length;j++){t=a[j];i=t.indexOf('=');if(i>0&&l.indexOf(','+t.substring(0,i)+',')>=0)b+=(b?'&':'')+t;else c+=(c?'&':'')+t}if(b&&c)q=b+'&'+c;else c=''}i=253-(q.length-c.length)-y.length;x=y+(i>0?p.substring(0,i):'')+'?'+q}}}}return x};s.s2q=function(k,v,vf,vfp,f){var s=this,qs='',sk,sv,sp,ss,nke,nk,nf,nfl=0,nfn,nfm;if(k==\"contextData\")k=\"c\";if(v){for(sk in v)if((!f||sk.substring(0,f.length)==f)&&v[sk]&&(!vf||vf.indexOf(','+(vfp?vfp+'.':'')+sk+',')>=0)&&(!Object||!Object.prototype||!Object.prototype[sk])){nfm=0;if(nfl)for(nfn=0;nfn<nfl.length;nfn++)if(sk.substring(0,nfl[nfn].length)==nfl[nfn])nfm=1;if(!nfm){if(qs=='')qs+='&'+k+'.';sv=v[sk];if(f)sk=sk.substring(f.length);if(sk.length>0){nke=sk.indexOf('.');if(nke>0){nk=sk.substring(0,nke);nf=(f?f:'')+nk+'.';if(!nfl)nfl=new Array;nfl[nfl.length]=nf;qs+=s.s2q(nk,v,vf,vfp,nf)}else{if(typeof(sv)=='boolean'){if(sv)sv='true';else sv='false'}if(sv){if(vfp=='retrieveLightData'&&f.indexOf('.contextData.')<0){sp=sk.substring(0,4);ss=sk.substring(4);if(sk=='transactionID')sk='xact';else if(sk=='channel')sk='ch';else if(sk=='campaign')sk='v0';else if(s.num(ss)){if(sp=='prop')sk='c'+ss;else if(sp=='eVar')sk='v'+ss;else if(sp=='list')sk='l'+ss;else if(sp=='hier'){sk='h'+ss;sv=sv.substring(0,255)}}}qs+='&'+s.ape(sk)+'='+s.ape(sv)}}}}}if(qs!='')qs+='&.'+k}return qs};s.hav=function(){var s=this,qs='',l,fv='',fe='',mn,i,e;if(s.lightProfileID){l=s.va_m;fv=s.lightTrackVars;if(fv)fv=','+fv+','+s.vl_mr+','}else{l=s.va_t;if(s.pe||s.linkType){fv=s.linkTrackVars;fe=s.linkTrackEvents;if(s.pe){mn=s.pe.substring(0,1).toUpperCase()+s.pe.substring(1);if(s[mn]){fv=s[mn].trackVars;fe=s[mn].trackEvents}}}if(fv)fv=','+fv+','+s.vl_l+','+s.vl_l2;if(fe){fe=','+fe+',';if(fv)fv+=',events,'}if (s.events2)e=(e?',':'')+s.events2}for(i=0;i<l.length;i++){var k=l[i],v=s[k],b=k.substring(0,4),x=k.substring(4),n=parseInt(x),q=k;if(!v)if(k=='events'&&e){v=e;e=''}if(v&&(!fv||fv.indexOf(','+k+',')>=0)&&k!='linkName'&&k!='linkType'){if(k=='timestamp')q='ts';else if(k=='dynamicVariablePrefix')q='D';else if(k=='visitorID')q='vid';else if(k=='pageURL'){q='g';v=s.fl(v,255)}else if(k=='referrer'){q='r';v=s.fl(s.rf(v),255)}else if(k=='vmk'||k=='visitorMigrationKey')q='vmt';else if(k=='visitorMigrationServer'){q='vmf';if(s.ssl&&s.visitorMigrationServerSecure)v=''}else if(k=='visitorMigrationServerSecure'){q='vmf';if(!s.ssl&&s.visitorMigrationServer)v=''}else if(k=='charSet'){q='ce';if(v.toUpperCase()=='AUTO')v='ISO8859-1';else if(s.em==2||s.em==3)v='UTF-8'}else if(k=='visitorNamespace')q='ns';else if(k=='cookieDomainPeriods')q='cdp';else if(k=='cookieLifetime')q='cl';else if(k=='variableProvider')q='vvp';else if(k=='currencyCode')q='cc';else if(k=='channel')q='ch';else if(k=='transactionID')q='xact';else if(k=='campaign')q='v0';else if(k=='resolution')q='s';else if(k=='colorDepth')q='c';else if(k=='javascriptVersion')q='j';else if(k=='javaEnabled')q='v';else if(k=='cookiesEnabled')q='k';else if(k=='browserWidth')q='bw';else if(k=='browserHeight')q='bh';else if(k=='connectionType')q='ct';else if(k=='homepage')q='hp';else if(k=='plugins')q='p';else if(k=='events'){if(e)v+=(v?',':'')+e;if(fe)v=s.fs(v,fe)}else if(k=='events2')v='';else if(k=='contextData'){qs+=s.s2q('c',s[k],fv,k,0);v=''}else if(k=='lightProfileID')q='mtp';else if(k=='lightStoreForSeconds'){q='mtss';if(!s.lightProfileID)v=''}else if(k=='lightIncrementBy'){q='mti';if(!s.lightProfileID)v=''}else if(k=='retrieveLightProfiles')q='mtsr';else if(k=='deleteLightProfiles')q='mtsd';else if(k=='retrieveLightData'){if(s.retrieveLightProfiles)qs+=s.s2q('mts',s[k],fv,k,0);v=''}else if(s.num(x)){if(b=='prop')q='c'+n;else if(b=='eVar')q='v'+n;else if(b=='list')q='l'+n;else if(b=='hier'){q='h'+n;v=s.fl(v,255)}}if(v)qs+='&'+s.ape(q)+'='+(k.substring(0,3)!='pev'?s.ape(v):v)}}return qs};s.ltdf=function(t,h){t=t?t.toLowerCase():'';h=h?h.toLowerCase():'';var qi=h.indexOf('?');h=qi>=0?h.substring(0,qi):h;if(t&&h.substring(h.length-(t.length+1))=='.'+t)return 1;return 0};s.ltef=function(t,h){t=t?t.toLowerCase():'';h=h?h.toLowerCase():'';if(t&&h.indexOf(t)>=0)return 1;return 0};s.lt=function(h){var s=this,lft=s.linkDownloadFileTypes,lef=s.linkExternalFilters,lif=s.linkInternalFilters;lif=lif?lif:s.wd.location.hostname;h=h.toLowerCase();if(s.trackDownloadLinks&&lft&&s.pt(lft,',','ltdf',h))return 'd';if(s.trackExternalLinks&&h.substring(0,1)!='#'&&(lef||lif)&&(!lef||s.pt(lef,',','ltef',h))&&(!lif||!s.pt(lif,',','ltef',h)))return 'e';return ''};s.lc=new Function('e','var s=s_c_il['+s._in+'],b=s.eh(this,\"onclick\");s.lnk=s.co(this);s.t();s.lnk=0;if(b)return this[b](e);return true');s.bc=new Function('e','var s=s_c_il['+s._in+'],f,tcf;if(s.d&&s.d.all&&s.d.all.cppXYctnr)return;s.eo=e.srcElement?e.srcElement:e.target;tcf=new Function(\"s\",\"var e;try{if(s.eo&&(s.eo.tagName||s.eo.parentElement||s.eo.parentNode))s.t()}catch(e){}\");tcf(s);s.eo=0');s.oh=function(o){var s=this,l=s.wd.location,h=o.href?o.href:'',i,j,k,p;i=h.indexOf(':');j=h.indexOf('?');k=h.indexOf('/');if(h&&(i<0||(j>=0&&i>j)||(k>=0&&i>k))){p=o.protocol&&o.protocol.length>1?o.protocol:(l.protocol?l.protocol:'');i=l.pathname.lastIndexOf('/');h=(p?p+'//':'')+(o.host?o.host:(l.host?l.host:''))+(h.substring(0,1)!='/'?l.pathname.substring(0,i<0?0:i)+'/':'')+h}return h};s.ot=function(o){var t=o.tagName;if(o.tagUrn||(o.scopeName&&o.scopeName.toUpperCase()!='HTML'))return '';t=t&&t.toUpperCase?t.toUpperCase():'';if(t=='SHAPE')t='';if(t){if((t=='INPUT'||t=='BUTTON')&&o.type&&o.type.toUpperCase)t=o.type.toUpperCase();else if(!t&&o.href)t='A';}return t};s.oid=function(o){var s=this,t=s.ot(o),p,c,n='',x=0;if(t&&!o.s_oid){p=o.protocol;c=o.onclick;if(o.href&&(t=='A'||t=='AREA')&&(!c||!p||p.toLowerCase().indexOf('javascript')<0))n=s.oh(o);else if(c){n=s.rep(s.rep(s.rep(s.rep(''+c,\"\\r\",''),\"\\n\",''),\"\\t\",''),' ','');x=2}else if(t=='INPUT'||t=='SUBMIT'){if(o.value)n=o.value;else if(o.innerText)n=o.innerText;else if(o.textContent)n=o.textContent;x=3}else if(o.src&&t=='IMAGE')n=o.src;if(n){o.s_oid=s.fl(n,100);o.s_oidt=x}}return o.s_oid};s.rqf=function(t,un){var s=this,e=t.indexOf('='),u=e>=0?t.substring(0,e):'',q=e>=0?s.epa(t.substring(e+1)):'';if(u&&q&&(','+u+',').indexOf(','+un+',')>=0){if(u!=s.un&&s.un.indexOf(',')>=0)q='&u='+u+q+'&u=0';return q}return ''};s.rq=function(un){if(!un)un=this.un;var s=this,c=un.indexOf(','),v=s.c_r('s_sq'),q='';if(c<0)return s.pt(v,'&','rqf',un);return s.pt(un,',','rq',0)};s.sqp=function(t,a){var s=this,e=t.indexOf('='),q=e<0?'':s.epa(t.substring(e+1));s.sqq[q]='';if(e>=0)s.pt(t.substring(0,e),',','sqs',q);return 0};s.sqs=function(un,q){var s=this;s.squ[un]=q;return 0};s.sq=function(q){var s=this,k='s_sq',v=s.c_r(k),x,c=0;s.sqq=new Object;s.squ=new Object;s.sqq[q]='';s.pt(v,'&','sqp',0);s.pt(s.un,',','sqs',q);v='';for(x in s.squ)if(x&&(!Object||!Object.prototype||!Object.prototype[x]))s.sqq[s.squ[x]]+=(s.sqq[s.squ[x]]?',':'')+x;for(x in s.sqq)if(x&&(!Object||!Object.prototype||!Object.prototype[x])&&s.sqq[x]&&(x==q||c<2)){v+=(v?'&':'')+s.sqq[x]+'='+s.ape(x);c++}return s.c_w(k,v,0)};s.wdl=new Function('e','var s=s_c_il['+s._in+'],r=true,b=s.eh(s.wd,\"onload\"),i,o,oc;if(b)r=this[b](e);for(i=0;i<s.d.links.length;i++){o=s.d.links[i];oc=o.onclick?\"\"+o.onclick:\"\";if((oc.indexOf(\"s_gs(\")<0||oc.indexOf(\".s_oc(\")>=0)&&oc.indexOf(\".tl(\")<0)s.eh(o,\"onclick\",0,s.lc);}return r');s.wds=function(){var s=this;if(s.apv>3&&(!s.isie||!s.ismac||s.apv>=5)){if(s.b&&s.b.attachEvent)s.b.attachEvent('onclick',s.bc);else if(s.b&&s.b.addEventListener)s.b.addEventListener('click',s.bc,false);else s.eh(s.wd,'onload',0,s.wdl)}};s.vs=function(x){var s=this,v=s.visitorSampling,g=s.visitorSamplingGroup,k='s_vsn_'+s.un+(g?'_'+g:''),n=s.c_r(k),e=new Date,y=e.getYear();e.setYear(y+10+(y<1900?1900:0));if(v){v*=100;if(!n){if(!s.c_w(k,x,e))return 0;n=x}if(n%10000>v)return 0}return 1};s.dyasmf=function(t,m){if(t&&m&&m.indexOf(t)>=0)return 1;return 0};s.dyasf=function(t,m){var s=this,i=t?t.indexOf('='):-1,n,x;if(i>=0&&m){var n=t.substring(0,i),x=t.substring(i+1);if(s.pt(x,',','dyasmf',m))return n}return 0};s.uns=function(){var s=this,x=s.dynamicAccountSelection,l=s.dynamicAccountList,m=s.dynamicAccountMatch,n,i;s.un=s.un.toLowerCase();if(x&&l){if(!m)m=s.wd.location.host;if(!m.toLowerCase)m=''+m;l=l.toLowerCase();m=m.toLowerCase();n=s.pt(l,';','dyasf',m);if(n)s.un=n}i=s.un.indexOf(',');s.fun=i<0?s.un:s.un.substring(0,i)};s.sa=function(un){var s=this;s.un=un;if(!s.oun)s.oun=un;else if((','+s.oun+',').indexOf(','+un+',')<0)s.oun+=','+un;s.uns()};s.m_i=function(n,a){var s=this,m,f=n.substring(0,1),r,l,i;if(!s.m_l)s.m_l=new Object;if(!s.m_nl)s.m_nl=new Array;m=s.m_l[n];if(!a&&m&&m._e&&!m._i)s.m_a(n);if(!m){m=new Object,m._c='s_m';m._in=s.wd.s_c_in;m._il=s._il;m._il[m._in]=m;s.wd.s_c_in++;m.s=s;m._n=n;m._l=new Array('_c','_in','_il','_i','_e','_d','_dl','s','n','_r','_g','_g1','_t','_t1','_x','_x1','_rs','_rr','_l');s.m_l[n]=m;s.m_nl[s.m_nl.length]=n}else if(m._r&&!m._m){r=m._r;r._m=m;l=m._l;for(i=0;i<l.length;i++)if(m[l[i]])r[l[i]]=m[l[i]];r._il[r._in]=r;m=s.m_l[n]=r}if(f==f.toUpperCase())s[n]=m;return m};s.m_a=new Function('n','g','e','if(!g)g=\"m_\"+n;var s=s_c_il['+s._in+'],c=s[g+\"_c\"],m,x,f=0;if(!c)c=s.wd[\"s_\"+g+\"_c\"];if(c&&s_d)s[g]=new Function(\"s\",s_ft(s_d(c)));x=s[g];if(!x)x=s.wd[\\'s_\\'+g];if(!x)x=s.wd[g];m=s.m_i(n,1);if(x&&(!m._i||g!=\"m_\"+n)){m._i=f=1;if((\"\"+x).indexOf(\"function\")>=0)x(s);else s.m_m(\"x\",n,x,e)}m=s.m_i(n,1);if(m._dl)m._dl=m._d=0;s.dlt();return f');s.m_m=function(t,n,d,e){t='_'+t;var s=this,i,x,m,f='_'+t,r=0,u;if(s.m_l&&s.m_nl)for(i=0;i<s.m_nl.length;i++){x=s.m_nl[i];if(!n||x==n){m=s.m_i(x);u=m[t];if(u){if((''+u).indexOf('function')>=0){if(d&&e)u=m[t](d,e);else if(d)u=m[t](d);else u=m[t]()}}if(u)r=1;u=m[t+1];if(u&&!m[f]){if((''+u).indexOf('function')>=0){if(d&&e)u=m[t+1](d,e);else if(d)u=m[t+1](d);else u=m[t+1]()}}m[f]=1;if(u)r=1}}return r};s.m_ll=function(){var s=this,g=s.m_dl,i,o;if(g)for(i=0;i<g.length;i++){o=g[i];if(o)s.loadModule(o.n,o.u,o.d,o.l,o.e,1);g[i]=0}};s.loadModule=function(n,u,d,l,e,ln){var s=this,m=0,i,g,o=0,f1,f2,c=s.h?s.h:s.b,b,tcf;if(n){i=n.indexOf(':');if(i>=0){g=n.substring(i+1);n=n.substring(0,i)}else g=\"m_\"+n;m=s.m_i(n)}if((l||(n&&!s.m_a(n,g)))&&u&&s.d&&c&&s.d.createElement){if(d){m._d=1;m._dl=1}if(ln){if(s.ssl)u=s.rep(u,'http:','https:');i='s_s:'+s._in+':'+n+':'+g;b='var s=s_c_il['+s._in+'],o=s.d.getElementById(\"'+i+'\");if(s&&o){if(!o.l&&s.wd.'+g+'){o.l=1;if(o.i)clearTimeout(o.i);o.i=0;s.m_a(\"'+n+'\",\"'+g+'\"'+(e?',\"'+e+'\"':'')+')}';f2=b+'o.c++;if(!s.maxDelay)s.maxDelay=250;if(!o.l&&o.c<(s.maxDelay*2)/100)o.i=setTimeout(o.f2,100)}';f1=new Function('e',b+'}');tcf=new Function('s','c','i','u','f1','f2','var e,o=0;try{o=s.d.createElement(\"script\");if(o){o.type=\"text/javascript\";'+(n?'o.id=i;o.defer=true;o.onload=o.onreadystatechange=f1;o.f2=f2;o.l=0;':'')+'o.src=u;c.appendChild(o);'+(n?'o.c=0;o.i=setTimeout(f2,100)':'')+'}}catch(e){o=0}return o');o=tcf(s,c,i,u,f1,f2)}else{o=new Object;o.n=n+':'+g;o.u=u;o.d=d;o.l=l;o.e=e;g=s.m_dl;if(!g)g=s.m_dl=new Array;i=0;while(i<g.length&&g[i])i++;g[i]=o}}else if(n){m=s.m_i(n);m._e=1}return m};s.voa=function(vo,r){var s=this,l=s.va_g,i,k,v,x;for(i=0;i<l.length;i++){k=l[i];v=vo[k];if(v||vo['!'+k]){if(!r&&(k==\"contextData\"||k==\"retrieveLightData\")&&s[k])for(x in s[k])if(!v[x])v[x]=s[k][x];s[k]=v}}};s.vob=function(vo){var s=this,l=s.va_g,i,k;for(i=0;i<l.length;i++){k=l[i];vo[k]=s[k];if(!vo[k])vo['!'+k]=1}};s.dlt=new Function('var s=s_c_il['+s._in+'],d=new Date,i,vo,f=0;if(s.dll)for(i=0;i<s.dll.length;i++){vo=s.dll[i];if(vo){if(!s.m_m(\"d\")||d.getTime()-vo._t>=s.maxDelay){s.dll[i]=0;s.t(vo)}else f=1}}if(s.dli)clearTimeout(s.dli);s.dli=0;if(f){if(!s.dli)s.dli=setTimeout(s.dlt,s.maxDelay)}else s.dll=0');s.dl=function(vo){var s=this,d=new Date;if(!vo)vo=new Object;s.vob(vo);vo._t=d.getTime();if(!s.dll)s.dll=new Array;s.dll[s.dll.length]=vo;if(!s.maxDelay)s.maxDelay=250;s.dlt()};s.track=s.t=function(vo){var s=this,trk=1,tm=new Date,sed=Math&&Math.random?Math.floor(Math.random()*10000000000000):tm.getTime(),sess='s'+Math.floor(tm.getTime()/10800000)%10+sed,y=tm.getYear(),vt=tm.getDate()+'/'+tm.getMonth()+'/'+(y<1900?y+1900:y)+' '+tm.getHours()+':'+tm.getMinutes()+':'+tm.getSeconds()+' '+tm.getDay()+' '+tm.getTimezoneOffset(),tcf,tfs=s.gtfs(),ta=-1,q='',qs='',code='',vb=new Object;s.gl(s.vl_g);s.uns();s.m_ll();if(!s.td){var tl=tfs.location,a,o,i,x='',c='',v='',p='',bw='',bh='',j='1.0',k=s.c_w('s_cc','true',0)?'Y':'N',hp='',ct='',pn=0,ps;if(String&&String.prototype){j='1.1';if(j.match){j='1.2';if(tm.setUTCDate){j='1.3';if(s.isie&&s.ismac&&s.apv>=5)j='1.4';if(pn.toPrecision){j='1.5';a=new Array;if(a.forEach){j='1.6';i=0;o=new Object;tcf=new Function('o','var e,i=0;try{i=new Iterator(o)}catch(e){}return i');i=tcf(o);if(i&&i.next)j='1.7'}}}}}if(s.apv>=4)x=screen.width+'x'+screen.height;if(s.isns||s.isopera){if(s.apv>=3){v=s.n.javaEnabled()?'Y':'N';if(s.apv>=4){c=screen.pixelDepth;bw=s.wd.innerWidth;bh=s.wd.innerHeight}}s.pl=s.n.plugins}else if(s.isie){if(s.apv>=4){v=s.n.javaEnabled()?'Y':'N';c=screen.colorDepth;if(s.apv>=5){bw=s.d.documentElement.offsetWidth;bh=s.d.documentElement.offsetHeight;if(!s.ismac&&s.b){tcf=new Function('s','tl','var e,hp=0;try{s.b.addBehavior(\"#default#homePage\");hp=s.b.isHomePage(tl)?\"Y\":\"N\"}catch(e){}return hp');hp=tcf(s,tl);tcf=new Function('s','var e,ct=0;try{s.b.addBehavior(\"#default#clientCaps\");ct=s.b.connectionType}catch(e){}return ct');ct=tcf(s)}}}else r=''}if(s.pl)while(pn<s.pl.length&&pn<30){ps=s.fl(s.pl[pn].name,100)+';';if(p.indexOf(ps)<0)p+=ps;pn++}s.resolution=x;s.colorDepth=c;s.javascriptVersion=j;s.javaEnabled=v;s.cookiesEnabled=k;s.browserWidth=bw;s.browserHeight=bh;s.connectionType=ct;s.homepage=hp;s.plugins=p;s.td=1}if(vo){s.vob(vb);s.voa(vo)}if((vo&&vo._t)||!s.m_m('d')){if(s.usePlugins)s.doPlugins(s);var l=s.wd.location,r=tfs.document.referrer;if(!s.pageURL)s.pageURL=l.href?l.href:l;if(!s.referrer&&!s._1_referrer){s.referrer=r;s._1_referrer=1}s.m_m('g');if(s.lnk||s.eo){var o=s.eo?s.eo:s.lnk,p=s.pageName,w=1,t=s.ot(o),n=s.oid(o),x=o.s_oidt,h,l,i,oc;if(s.eo&&o==s.eo){while(o&&!n&&t!='BODY'){o=o.parentElement?o.parentElement:o.parentNode;if(o){t=s.ot(o);n=s.oid(o);x=o.s_oidt}}if(!n||t=='BODY')o='';if(o){oc=o.onclick?''+o.onclick:'';if((oc.indexOf('s_gs(')>=0&&oc.indexOf('.s_oc(')<0)||oc.indexOf('.tl(')>=0)o=0}}if(o){if(n)ta=o.target;h=s.oh(o);i=h.indexOf('?');h=s.linkLeaveQueryString||i<0?h:h.substring(0,i);l=s.linkName;t=s.linkType?s.linkType.toLowerCase():s.lt(h);if(t&&(h||l)){s.pe='lnk_'+(t=='d'||t=='e'?t:'o');s.pev1=(h?s.ape(h):'');s.pev2=(l?s.ape(l):'')}else trk=0;if(s.trackInlineStats){if(!p){p=s.pageURL;w=0}t=s.ot(o);i=o.sourceIndex;if(s.gg('objectID')){n=s.gg('objectID');x=1;i=1}if(p&&n&&t)qs='&pid='+s.ape(s.fl(p,255))+(w?'&pidt='+w:'')+'&oid='+s.ape(s.fl(n,100))+(x?'&oidt='+x:'')+'&ot='+s.ape(t)+(i?'&oi='+i:'')}}else trk=0}if(trk||qs){s.sampled=s.vs(sed);if(trk){if(s.sampled)code=s.mr(sess,(vt?'&t='+s.ape(vt):'')+s.hav()+q+(qs?qs:s.rq()),0,ta);qs='';s.m_m('t');if(s.p_r)s.p_r();s.referrer=s.lightProfileID=s.retrieveLightProfiles=s.deleteLightProfiles=''}s.sq(qs)}}else s.dl(vo);if(vo)s.voa(vb,1);s.lnk=s.eo=s.linkName=s.linkType=s.wd.s_objectID=s.ppu=s.pe=s.pev1=s.pev2=s.pev3='';if(s.pg)s.wd.s_lnk=s.wd.s_eo=s.wd.s_linkName=s.wd.s_linkType='';return code};s.trackLink=s.tl=function(o,t,n,vo){var s=this;s.lnk=s.co(o);s.linkType=t;s.linkName=n;s.t(vo)};s.trackLight=function(p,ss,i,vo){var s=this;s.lightProfileID=p;s.lightStoreForSeconds=ss;s.lightIncrementBy=i;s.t(vo)};s.setTagContainer=function(n){var s=this,l=s.wd.s_c_il,i,t,x,y;s.tcn=n;if(l)for(i=0;i<l.length;i++){t=l[i];if(t&&t._c=='s_l'&&t.tagContainerName==n){s.voa(t);if(t.lmq)for(i=0;i<t.lmq.length;i++){x=t.lmq[i];y='m_'+x.n;if(!s[y]&&!s[y+'_c']){s[y]=t[y];s[y+'_c']=t[y+'_c']}s.loadModule(x.n,x.u,x.d)}if(t.ml)for(x in t.ml)if(s[x]){y=s[x];x=t.ml[x];for(i in x)if(!Object.prototype[i]){if(typeof(x[i])!='function'||(''+x[i]).indexOf('s_c_il')<0)y[i]=x[i]}}if(t.mmq)for(i=0;i<t.mmq.length;i++){x=t.mmq[i];if(s[x.m]){y=s[x.m];if(y[x.f]&&typeof(y[x.f])=='function'){if(x.a)y[x.f].apply(y,x.a);else y[x.f].apply(y)}}}if(t.tq)for(i=0;i<t.tq.length;i++)s.t(t.tq[i]);t.s=s;return}}};s.wd=window;s.ssl=(s.wd.location.protocol.toLowerCase().indexOf('https')>=0);s.d=document;s.b=s.d.body;if(s.d.getElementsByTagName){s.h=s.d.getElementsByTagName('HEAD');if(s.h)s.h=s.h[0]}s.n=navigator;s.u=s.n.userAgent;s.ns6=s.u.indexOf('Netscape6/');var apn=s.n.appName,v=s.n.appVersion,ie=v.indexOf('MSIE '),o=s.u.indexOf('Opera '),i;if(v.indexOf('Opera')>=0||o>0)apn='Opera';s.isie=(apn=='Microsoft Internet Explorer');s.isns=(apn=='Netscape');s.isopera=(apn=='Opera');s.ismac=(s.u.indexOf('Mac')>=0);if(o>0)s.apv=parseFloat(s.u.substring(o+6));else if(ie>0){s.apv=parseInt(i=v.substring(ie+5));if(s.apv>3)s.apv=parseFloat(i)}else if(s.ns6>0)s.apv=parseFloat(s.u.substring(s.ns6+10));else s.apv=parseFloat(v);s.em=0;if(s.em.toPrecision)s.em=3;else if(String.fromCharCode){i=escape(String.fromCharCode(256)).toUpperCase();s.em=(i=='%C4%80'?2:(i=='%U0100'?1:0))}if(s.oun)s.sa(s.oun);s.sa(un);s.vl_l='timestamp,dynamicVariablePrefix,visitorID,vmk,visitorMigrationKey,visitorMigrationServer,visitorMigrationServerSecure,ppu,charSet,visitorNamespace,cookieDomainPeriods,cookieLifetime,pageName,pageURL,referrer,contextData,currencyCode,lightProfileID,lightStoreForSeconds,lightIncrementBy,retrieveLightProfiles,deleteLightProfiles,retrieveLightData';s.va_l=s.sp(s.vl_l,',');s.vl_mr=s.vl_m='timestamp,charSet,visitorNamespace,cookieDomainPeriods,cookieLifetime,contextData,lightProfileID,lightStoreForSeconds,lightIncrementBy';s.vl_t=s.vl_l+',variableProvider,channel,server,pageType,transactionID,purchaseID,campaign,state,zip,events,events2,products,linkName,linkType';var n;for(n=1;n<=75;n++){s.vl_t+=',prop'+n+',eVar'+n;s.vl_m+=',prop'+n+',eVar'+n}for(n=1;n<=5;n++)s.vl_t+=',hier'+n;for(n=1;n<=3;n++)s.vl_t+=',list'+n;s.va_m=s.sp(s.vl_m,',');s.vl_l2=',tnt,pe,pev1,pev2,pev3,resolution,colorDepth,javascriptVersion,javaEnabled,cookiesEnabled,browserWidth,browserHeight,connectionType,homepage,plugins';s.vl_t+=s.vl_l2;s.va_t=s.sp(s.vl_t,',');s.vl_g=s.vl_t+',trackingServer,trackingServerSecure,trackingServerBase,fpCookieDomainPeriods,disableBufferedRequests,mobile,visitorSampling,visitorSamplingGroup,dynamicAccountSelection,dynamicAccountList,dynamicAccountMatch,trackDownloadLinks,trackExternalLinks,trackInlineStats,linkLeaveQueryString,linkDownloadFileTypes,linkExternalFilters,linkInternalFilters,linkTrackVars,linkTrackEvents,linkNames,lnk,eo,lightTrackVars,_1_referrer,un';s.va_g=s.sp(s.vl_g,',');s.pg=pg;s.gl(s.vl_g);s.contextData=new Object;s.retrieveLightData=new Object;if(!ss)s.wds();if(pg){s.wd.s_co=function(o){s_gi(\"_\",1,1).co(o)};s.wd.s_gs=function(un){s_gi(un,1,1).t()};s.wd.s_dc=function(un){s_gi(un,1).t()}}",w=window,l=w.s_c_il,n=navigator,u=n.userAgent,v=n.appVersion,e=v.indexOf("MSIE "),m=u.indexOf("Netscape6/"),a,i,j,x,s;if(un){un=un.toLowerCase();if(l)for(j=0;j<2;j++)for(i=0;i<l.length;i++){s=l[i];x=s._c;if((!x||x=="s_c"||j>0&&x=="s_l")&&(s.oun==un||s.fs&&s.sa&&s.fs(s.oun,un))){if(s.sa)s.sa(un);if(x=="s_c")return s}else s=0}}w.s_an="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";w.s_sp=new Function("x","d","var a=new Array,i=0,j;if(x){if(x.split)a=x.split(d);else if(!d)for(i=0;i<x.length;i++)a[a.length]=x.substring(i,i+1);else while(i>=0){j=x.indexOf(d,i);a[a.length]=x.substring(i,j<0?x.length:j);i=j;if(i>=0)i+=d.length}}return a");w.s_jn=new Function("a","d","var x='',i,j=a.length;if(a&&j>0){x=a[0];if(j>1){if(a.join)x=a.join(d);else for(i=1;i<j;i++)x+=d+a[i]}}return x");w.s_rep=new Function("x","o","n","return s_jn(s_sp(x,o),n)");w.s_d=new Function("x","var t='`^@$#',l=s_an,l2=new Object,x2,d,b=0,k,i=x.lastIndexOf('~~'),j,v,w;if(i>0){d=x.substring(0,i);x=x.substring(i+2);l=s_sp(l,'');for(i=0;i<62;i++)l2[l[i]]=i;t=s_sp(t,'');d=s_sp(d,'~');i=0;while(i<5){v=0;if(x.indexOf(t[i])>=0) {x2=s_sp(x,t[i]);for(j=1;j<x2.length;j++){k=x2[j].substring(0,1);w=t[i]+k;if(k!=' '){v=1;w=d[b+l2[k]]}x2[j]=w+x2[j].substring(1)}}if(v)x=s_jn(x2,'');else{w=t[i]+' ';if(x.indexOf(w)>=0)x=s_rep(x,w,t[i]);i++;b+=62}}}return x");w.s_fe=new Function("c","return s_rep(s_rep(s_rep(c,'\\\\','\\\\\\\\'),'\"','\\\\\"'),\"\\n\",\"\\\\n\")");w.s_fa=new Function("f","var s=f.indexOf('(')+1,e=f.indexOf(')'),a='',c;while(s>=0&&s<e){c=f.substring(s,s+1);if(c==',')a+='\",\"';else if((\"\\n\\r\\t \").indexOf(c)<0)a+=c;s++}return a?'\"'+a+'\"':a");w.s_ft=new Function("c","c+='';var s,e,o,a,d,q,f,h,x;s=c.indexOf('=function(');while(s>=0){s++;d=1;q='';x=0;f=c.substring(s);a=s_fa(f);e=o=c.indexOf('{',s);e++;while(d>0){h=c.substring(e,e+1);if(q){if(h==q&&!x)q='';if(h=='\\\\')x=x?0:1;else x=0}else{if(h=='\"'||h==\"'\")q=h;if(h=='{')d++;if(h=='}')d--}if(d>0)e++}c=c.substring(0,s)+'new Function('+(a?a+',':'')+'\"'+s_fe(c.substring(o+1,e))+'\")'+c.substring(e+1);s=c.indexOf('=function(')}return c;");c=s_d(c);if(e>0){a=parseInt(i=v.substring(e+5));if(a>3)a=parseFloat(i)}else if(m>0)a=parseFloat(u.substring(m+10));else a=parseFloat(v);if(a<5||v.indexOf("Opera")>=0||u.indexOf("Opera")>=0)c=s_ft(c);if(!s){s={};if(!w.s_c_in){w.s_c_il=[];w.s_c_in=0}s._il=w.s_c_il;s._in=w.s_c_in;s._il[s._in]=s;w.s_c_in++}s._c="s_c";new Function("s","un","pg","ss",c)(s,un,pg,ss);return s}function s_giqf(){var w=window,q=w.s_giq,i,t,s;if(q)for(i=0;i<q.length;i++){t=q[i];s=s_gi(t.oun);s.sa(t.un);s.setTagContainer(t.tagContainerName)}w.s_giq=0}s_giqf();T2S={AppId:null,Enabled:null,Proxy:null,ProxyCall:null,MaxLength:null,ToLanguage:null,AudioUrl:"",Player:false,QTPlayerId:"qtsound",Init:function(appid,enabled,maxlen,proxy){this.AppId=appid;this.MaxLength=maxlen;this.Proxy=proxy;this.Enabled=enabled},GetBaseParams:function(isWav){if(isWav)return "/Speak?language="+this.ToLanguage+"&appid="+this.AppId+"&text=";else return "/Speak?language="+this.ToLanguage+"&format=audio/mp3"+"&options=MaxQuality"+"&appid="+this.AppId+"&text="},PlayQTSound:function(playlist){var playIndex=0,parent=document.getElementById("mediaPlayerHolder"),oldChild=document.getElementById(this.QTPlayerId);if(playlist.length==0){if(oldChild!=null)parent.removeChild(oldChild);return}var newChild=document.createElement("embed");newChild.setAttribute("autostart","true");newChild.setAttribute("width","0");newChild.setAttribute("height","0");newChild.setAttribute("id",this.QTPlayerId);newChild.setAttribute("hidden","true");newChild.setAttribute("style","position:absolute;z-index:99;top:-300;left:-300;visibility:hidden;");newChild.setAttribute("src",this.GetUrl(playlist[playIndex++]));newChild.setAttribute("postdomevents","true");if(oldChild!=null)parent.replaceChild(newChild,oldChild);else parent.appendChild(newChild);var me=this;Util.AddEvent(newChild,"qt_ended",function(event){newChild.setAttribute("src",me.GetUrl(playlist[playIndex++]))})},PlayIESound:function(url){document.getElementById("iesound").src=url},PlayHTML5Sound:function(playlist){try{var playIndex=0;if(!this.Player)this.Player=new Audio;var player=this.Player;if(playlist.length==0){player.pause();player.src="";return true}var me=this;if(player.canPlayType("audio/mp3")){player.src=this.GetUrl(playlist[playIndex++]);Util.AddEvent(this.Player,"ended",function(event){if(playIndex<playlist.length){player.src=me.GetUrl(playlist[playIndex++]);player.play()}})}else if(player.canPlayType("audio/wav")){player.src=this.GetUrl(playlist[playIndex++],true);Util.AddEvent(this.Player,"ended",function(event){if(playIndex<playlist.length){player.src=me.GetUrl(playlist[playIndex++],true);player.play()}})}else return false;player.play()}catch(ex){return false}return true},Get_TextTags:function(){var tags=[],aSpans=Default.OutputElement.getInput().getElementsByTagName("font");for(var j=0;j<aSpans.length;++j)if(aSpans[j].getAttribute("lang"))tags.push(aSpans[j]);return tags},Play:function(){this.SetNewTranslation();var tags=this.Get_TextTags(),txts=[],temp="";for(var i=0;i<tags.length;i++){temp=tags[i].innerText||tags[i].textContent||"";temp=temp.replace(/\s+/g," ").trim();if(temp)txts.push(temp)}this.PlayText(txts)},PlayText:function(textList){if(textList&&textList.length>0){textList.push("");var playlist=[],tempStr="",tempInt=0,text="";for(var i=0;i<textList.length;i++){text=(text+" "+textList[i]).trim();while(text.length>this.MaxLength){tempStr=text.substr(0,this.MaxLength);if((tempInt=tempStr.lastIndexOf("."))>0)tempStr=tempStr.substr(0,tempInt);else if((tempInt=tempStr.lastIndexOf(" "))>0)tempStr=tempStr.substr(0,tempInt);else tempInt=this.MaxLength;text=text.slice(tempInt+1).trim();playlist.push(encodeURIComponent(tempStr).replace(/%20/g,"+").trim("+"))}if(textList[i].length>0){tempStr=(text+" "+textList[i+1]).trim();if(tempStr.length>this.MaxLength){playlist.push(encodeURIComponent(text).replace(/%20/g,"+").trim("+"));text=""}}else if(text.length>0){playlist.push(encodeURIComponent(text).replace(/%20/g,"+").trim("+"));text=""}}if(!this.PlayHTML5Sound(playlist)){var url=this.GetUrl(playlist[0]);if(navigator.appVersion.indexOf("MSIE")>=0)this.PlayIESound(url);else this.PlayQTSound(playlist)}}},GetUrl:function(txt,isWav){return this.Proxy+this.GetBaseParams(isWav)+txt},SetPreTrans:function(){this.Translating=true},SetNewTranslation:function(){this.ToLanguage=Default.Language.getTo();if(navigator.appVersion.indexOf("MSIE")>=0)document.getElementById("iesound").src="about:blank";this.PlayHTML5Sound("");this.PlayQTSound("")}};Text2Speech={NameSpace:null,SrcText:null,ToLang:null,Proxy:null,AppId:null,ClientId:"_mtsnd",Stop:function(){var dummy="nosnd.wav",e=document.getElementById(this.NameSpace+this.ClientId);if(e!=null)e.src=dummy},Play:function(senderId){try{var Params="text="+this.SrcText+"&language="+this.ToLang+"&format=audio/mp3"+"&options=MaxQuality"+"&appid="+this.AppId,ProxyCall=this.Proxy+"/Speak?"+Params;if(senderId!=null&&document.getElementById(senderId)!=null)document.getElementById(senderId).blur();if(Params.length>1600)return;if(!Util.MSIE){var oldChild=document.getElementById(this.NameSpace+this.ClientId),parent=oldChild.parentNode,newChild=document.createElement("embed");newChild.setAttribute("autostart","true");newChild.setAttribute("width","100");newChild.setAttribute("height","100");newChild.setAttribute("id",this.NameSpace+this.ClientId);newChild.setAttribute("hidden","false");newChild.setAttribute("style","position:absolute;z-index:99;top:-300;left:-300;visibility:hidden;");newChild.setAttribute("src",ProxyCall);parent.replaceChild(newChild,oldChild)}else document.getElementById(this.NameSpace+this.ClientId).src=ProxyCall}catch(e){alert(e.description)}},AddEvent:function(elem,sEvent,fn){if(elem.addEventListener)elem.addEventListener(sEvent,fn,false);else if(elem.attachEvent)elem.attachEvent("on"+sEvent,fn)}};Tools=new CTools;function CTools(){return this}CTools.prototype.Init=function(){};function CUtil(){var agent=navigator.userAgent.toLowerCase();this.MSIE=agent.indexOf("msie")!=-1&&agent.indexOf("opera")==-1;this.MSIE6=this.MSIE&&agent.indexOf("msie 6.")!=-1;this.MSIE7=this.MSIE&&agent.indexOf("msie 7.")!=-1;this.FIREFOX=agent.indexOf("firefox")!=-1;this.SAFARI=agent.indexOf("applewebkit")!=-1;this.GetPath=function(){var cPath="/";if(location.pathname){cPath=location.pathname.match(/\/\w*/i);if(cPath)cPath=cPath[0]}return cPath};this.AddFavorites=function(){var strTitle=document.title,strUrl=window.location.href;if(this.FIREFOX)window.sidebar.addPanel(strTitle,strUrl,"");else window.external.AddFavorite(strUrl,strTitle)};this.SetCookie=function(strCookieName,strCookieValue,bPersist,strPath){if(!strPath)strPath="/";document.cookie=strCookieName+"="+strCookieValue+(bPersist?"; expires=Sun, 01-Jan-2040 01:01:01 GMT":"")+"; path="+strPath};this.DeleteCookie=function(strCookieName,strPath){if(!strPath)strPath="/";document.cookie=strCookieName+"=;Thu, 01 Jan 1970 00:00:01 GMT; path="+strPath};this.GetCookie=function(strCookieName){var rgxCookieValue=eval("document.cookie.match(/"+strCookieName+"s*=([^;]*)(;|$)/);");if(rgxCookieValue!=null)return rgxCookieValue[1];else{rgxCookieValue=eval("document.cookie.match(/"+strCookieName+"s*([^;]*)(;|$)/);");if(rgxCookieValue!=null)return rgxCookieValue[1];else return null}};this.AddEvent=function(elem,strEvent,fnctPtr){if(elem.addEventListener)elem.addEventListener(strEvent,fnctPtr,false);else if(elem.attachEvent)elem.attachEvent("on"+strEvent,fnctPtr)};this.AbsXPos=function(elem){return elem.offsetLeft+(elem.offsetParent!=null?this.AbsXPos(elem.offsetParent):0)};this.AbsYPos=function(elem){return elem.offsetTop+(elem.offsetParent!=null?this.AbsYPos(elem.offsetParent):0)};this.SetDDLByVal=function(value,elemDDL){for(var i=0;i<elemDDL.options.length;i++)if(elemDDL.options[i].value==value){elemDDL.options[i].selected=true;return}};this.GetElement=function(id){if(arguments.length<=0)return null;if(document.getElementById)return document.getElementById(id);else if(document.all)return document.all(id);else if(document.layers)return window.document.layers[id];else return null};this.GetStyleObject=function(objectId){if(document.getElementById&&document.getElementById(objectId))return document.getElementById(objectId).style;else if(document.all&&document.all(objectId))return document.all(objectId).style;else if(document.layers&&document.layers[objectId])return document.layers[objectId];else return false};this.GetStyleValue=function(objectId,styleProp){var x=document.getElementById(objectId)||document.body,y;if(x.currentStyle)y=x.currentStyle[styleProp]||x.currentStyle.getAttribute(styleProp.replace("-"));else if(window.getComputedStyle)y=document.defaultView.getComputedStyle(x,null).getPropertyValue(styleProp);return y};this.GetScrollBounds=function(documentObject){if(documentObject==null)return {x:0,y:0,width:0,height:0};var x,y,width,height;if(documentObject.documentElement!=null&&documentObject.documentElement.scrollTop!=null&&documentObject.documentElement.scrollTop>=documentObject.body.scrollTop){x=documentObject.documentElement.scrollLeft;y=documentObject.documentElement.scrollTop;width=documentObject.documentElement.scrollWidth;height=documentObject.documentElement.scrollHeight}else{x=documentObject.body.scrollLeft;y=documentObject.body.scrollTop;width=documentObject.body.scrollWidth;height=documentObject.body.scrollHeight}return {x:x,y:y,width:width,height:height}};this.getLanguageDirStyle=function(sLang){var oDirStyle;if(Microsoft.Translator.languageDirs[sLang]=="rtl")oDirStyle={direction:"rtl",textAlign:"right"};else oDirStyle={direction:"ltr",textAlign:"left"};return oDirStyle};this.setScrollValue=function(rootHTMLNode,scrollValue,xShift,yShift,sPosition){var winObj=rootHTMLNode.ownerDocument.defaultView?rootHTMLNode.ownerDocument.defaultView:rootHTMLNode.ownerDocument.parentWindow;if(winObj.scrollBy)winObj.scrollBy(xShift,yShift);else{rootHTMLNode["scroll"+sPosition]=scrollValue;rootHTMLNode.ownerDocument.body["scroll"+sPosition]=scrollValue}};this.GetUrlParameter=function(InUrl,InParamName){InParamName=InParamName.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var Pattern="[\\?&]"+InParamName+"=([^&#]*)",Regex=new RegExp(Pattern,"i"),Results=Regex.exec(InUrl);if(Results==null)return null;else return Results[1]};this.GetDocumentUrl=function(document){var url="";if(document.location.hash.length>1)url=document.location.hash.substring(1);else if(document.location.search.indexOf("a=")>0)url=decodeURIComponent(document.location.search.substring(document.location.search.indexOf("a=")+2));while(url&&url.toLowerCase().indexOf("/bv.aspx")>=0&&url.toLowerCase().indexOf("a=")>=0)url=decodeURIComponent(url.substring(url.toLowerCase().indexOf("a=")+2));if(url.length>0){url=url.replace(/^\s*/,"").replace(/\s*$/,"");if(url.indexOf("?")==-1)url=url.replace("&","?")}if(url&&url.indexOf("://")==-1)url="http://"+url;if(url&&url.toLowerCase().indexOf("/bv.aspx")>=0)url="";return url};this.SendPostRequest=function(url,params,target){var form=document.createElement("form");form.action=url;form.method="post";form.target=target;for(var key in params)if(params.hasOwnProperty(key)){var input=document.createElement("input");input.name=key;input.value=params[key];input.type="hidden";form.appendChild(input)}document.body.appendChild(form);form.submit();document.body.removeChild(form)};this.Log=function(source,params){Microsoft.Translator.LoadScript("/sync.ashx?svc="+source+"&"+params.join("&"))};this.GetCaretPosition=function(input){var caretPos=0;if(input.selectionStart||input.selectionStart=="0")caretPos=input.selectionStart;else if(document.selection){var range=document.selection.createRange(),start=0,end=0;if(range&&range.parentElement()==input){var len=input.value.length,normalizedValue=input.value.replace(/\r\n/g,"\n"),textInputRange=input.createTextRange();textInputRange.moveToBookmark(range.getBookmark());var endRange=input.createTextRange();endRange.collapse(false);if(textInputRange.compareEndPoints("StartToEnd",endRange)>-1)start=end=len;else{start=-textInputRange.moveStart("character",-len);if(textInputRange.compareEndPoints("EndToEnd",endRange)>-1)end=len;else end=-textInputRange.moveEnd("character",-len)}}caretPos=start}return caretPos};this.SetSelectionRange=function(input,selectionStart,selectionEnd){if(input.setSelectionRange){input.focus();input.setSelectionRange(selectionStart,selectionEnd)}else if(input.createTextRange){var range=input.createTextRange();range.collapse(true);range.moveEnd("character",selectionEnd);range.moveStart("character",selectionStart);range.select()}};this.SetCaretToPosition=function(input,pos){this.SetSelectionRange(input,pos,pos)};this.addClass=function(obj,className){var classNames=obj.className.split(" ");for(var i=0;i<classNames.length;i++)if(className==classNames[i])return;obj.className+=" "+className};this.removeClass=function(obj,className){var classNames=obj.className.split(" ");obj.className="";for(var i=0;i<classNames.length;i++)if(className!=classNames[i]){obj.className+=classNames[i];if(i==classNames.length-1)obj.className+=" "}};this.getPosition=function(elem){var x=0,y=0;while(elem&&!isNaN(elem.offsetLeft)&&!isNaN(elem.offsetTop)){x+=elem.offsetLeft-elem.scrollLeft;y+=elem.offsetTop-elem.scrollTop;elem=elem.offsetParent}return {top:y,left:x}};this.IsElementInViewport=function(elem){var rect=elem.getBoundingClientRect();return rect.top>=0&&rect.left>=0&&rect.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&rect.right<=(window.innerWidth||document.documentElement.clientWidth)};return this}var Util=new CUtil